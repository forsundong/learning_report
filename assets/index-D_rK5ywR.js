import{r as u,F as e,G as Se,R as ke}from"./vendor-base-7ebbgd7M.js";import{r as Ce,u as _e}from"./vendor-xlsx-BUW7exb-.js";import{C as $e,U as he,a as Ae,F as Me,A as Te,S as ge,P as oe,b as pe,D as Be,X as Ie,c as Re,R as ae,d as Le,e as Ee,T as Oe,Z as ie,f as ee,g as Ue,h as Pe,i as De,L as Fe,M as qe,j as He,k as Ke,l as We,m as ze,G as Ge,n as Je}from"./vendor-icons-BuHkid3k.js";import{R as Ve,L as Ye,C as Ze,X as Xe,Y as Qe,T as et,a as ce}from"./vendor-charts-CnHc5vBf.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const be={ä¸€å¹´çº§:["åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘åˆæ­¥","åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘è¿›é˜¶","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],ä¸€å¹´çº§å¼¹çª—:["ç©ºé—´æƒ³è±¡â€”â€”æ­£æ–¹ä½“è®¡æ•°","ç©ºé—´æƒ³è±¡â€”â€”æ•°æ•°çœ‹ä¸è§","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],äºŒå¹´çº§:["åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜è¿›é˜¶","åº”ç”¨é¢˜â€”â€”è¿˜åŸå€’æ¨","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œåˆæ­¥","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œè¿›é˜¶"],ä¸‰å¹´çº§:["åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜è¿›é˜¶","è½¬åŒ–æ€æƒ³â€”å·§æ±‚æœ€çŸ­è·¯çº¿","è®¡ç®—â€”â€”å·§å¡«ç®—ç¬¦","è®¡ç®—â€”â€”å·§è§£æ•´æ•°è®¡ç®—"],å››å¹´çº§:["ç›ˆäºé—®é¢˜","ç”Ÿæ´»ä¸­çš„è®¡æ•°åŸç†","å›¾å½¢ä¸­çš„è®¡æ•°åŸç†","é•¿æ–¹å½¢ä¸­çš„å€æ•°å…³ç³»","æ•°å½¢ç»“åˆ"],äº”å¹´çº§:["åŸºç¡€è¡Œç¨‹é—®é¢˜","ç¯å½¢è·¯çº¿é—®é¢˜","ç«è½¦è¡Œç¨‹é—®é¢˜","å°æ•°ä¹˜é™¤æ³•å·§ç®—","å°æ•°æå–å…¬å› æ•°"],å…­å¹´çº§:["é—´éš”å‘è½¦é—®é¢˜","ç‰¹æ®Šæ³•æ¯”è¾ƒåˆ†æ•°å¤§å°","æ“ä½œä¸è§„å¾‹","ä¸å®šæ–¹ç¨‹","çŸ­é™¤æ¨¡å‹"]},tt=s=>{if(!s||isNaN(s))return"0åˆ†é’Ÿ";const n=Math.floor(s/3600),o=s%3600,l=Math.ceil(o/60);return n>0?`${n}å°æ—¶${l>0?` ${l}åˆ†é’Ÿ`:""}`:`${l}åˆ†é’Ÿ`},B=s=>{if(s==null)return 0;if(typeof s=="number")return s*100;if(typeof s=="string"){if(s.includes("%"))return parseFloat(s.replace("%",""));const n=parseFloat(s);return n<=1?n*100:n}return 0},Q=s=>{if(typeof s=="number")return s;if(!s)return 0;const n=String(s).trim();if(n.includes("åˆ†")||n.includes("ç§’")){let l=0;const r=n.match(/(\d+)\s*åˆ†/),a=n.match(/(\d+)\s*ç§’/);return r&&(l+=parseInt(r[1],10)*60),a&&(l+=parseInt(a[1],10)),l}const o=parseFloat(n);return isNaN(o)?0:o},re=s=>{if(!s)return"æœªçŸ¥å¹´çº§";const n={pk:"å¹¼å„¿å›­å°ç­",k:"å¹¼å„¿å›­å¤§ç­",one:"ä¸€å¹´çº§",two:"äºŒå¹´çº§",three:"ä¸‰å¹´çº§",four:"å››å¹´çº§",five:"äº”å¹´çº§",six:"å…­å¹´çº§"},o=s.toLowerCase().trim();if(n[o])return n[o];const l=Object.keys(n).find(r=>o.includes(r));return l?n[l]:s},st=(s,n)=>{const o=new Set;return s.forEach(l=>{if(l.real_name===n){const r=parseInt(String(l.level_sequence),10);isNaN(r)||o.add(r)}}),Array.from(o).sort((l,r)=>l-r)},at=s=>{if(!s||s.length===0)return{valid:!1,error:"æ–‡ä»¶ä¸ºç©º"};const n=s[0],l=["real_name","level_sequence","unit_sequence","unit_finish_status","answer_right_rate","first_cost_seconds"].filter(r=>!(r in n));return l.length>0?{valid:!1,error:`ç¼ºå°‘å¿…è¦å­—æ®µ: ${l.join(", ")}`}:{valid:!0}},de=s=>s>=4?{name:"é‡‘ç‰Œå®Œè¯¾ç‹",type:"completion",level:"gold",description:"é‡‘ç‰Œæˆå°±è¾¾æˆï¼å…¨è¯¾ç¨‹é€šå…³ï¼Œä½ å°±æ˜¯å­¦ä¹ ç‹è€…ï¼"}:{name:"å­¦ä¹ ä¹‹æ˜Ÿ",type:"completion",level:"star",description:"å­¦ä¹ ä¹‹æ˜Ÿå·²ç‚¹äº®ï¼è¡¨ç°éå¸¸äº®çœ¼ï¼ŒåŠ æ²¹å‘å‰å†²ï¼"},xe=s=>s>=90?{name:"å­¦ä¹ å…¸èŒƒ",type:"accuracy",level:"model",description:"ä½ çš„å­¦ä¹ è´¨é‡æé«˜ï¼Œå±•ç°å…¸èŒƒçº§çš„æŒæ¡åŠ›ã€‚"}:{name:"ç¨³å®šé«˜æ‰‹",type:"accuracy",level:"master",description:"ç¨³å®šä¸”æ‰å®ï¼Œä¿æŒè¿™ä¸ªèŠ‚å¥ï¼"},me=(s,n,o,l)=>{var j,g,i,y;if(!s||s.length===0)return null;const r=s.filter(N=>N.real_name===n);if(r.length===0)return null;const a=[],c=l?l.max:Math.max(...r.map(N=>parseInt(String(N.level_sequence),10))),h=r.filter(N=>parseInt(String(N.level_sequence),10)===c);if(o==="headteacher"){h.forEach(x=>{const S=parseInt(String(x.unit_sequence),10),R=B(x.answer_right_rate),H=B(x.pass_rate),_=s.filter(C=>parseInt(String(C.level_sequence),10)===c&&parseInt(String(C.unit_sequence),10)===S),p=_.filter(C=>B(C.answer_right_rate)>0),d=p.length>0?p.reduce((C,U)=>C+B(U.answer_right_rate),0)/p.length:0,O=_.filter(C=>B(C.pass_rate)>0),W=O.length>0?O.reduce((C,U)=>C+B(U.pass_rate),0)/O.length:0,L=_.filter(C=>Q(C.first_cost_seconds)>0),D=L.length>0?L.reduce((C,U)=>C+Q(U.first_cost_seconds),0)/L.length:0;a.push({unitNumber:S,unitName:S===0?"è¯¾å‰æµ‹":`ç¬¬${S}è®²`,timeSpentSeconds:Q(x.first_cost_seconds),classTimeSpentSeconds:D,status:x.unit_finish_status==="å®Œè¯¾"?"high":"low",statusLabel:x.unit_finish_status==="å®Œè¯¾"?"å·²å®Œæˆ":"å­¦ä¹ ä¸­",accuracy:R,classAccuracy:d,passRate:H,classPassRate:W,wrongCount:parseInt(String(x.first_finish_answer_step_fail_cnt??x.wrong_answer_count??0)),analysis:""})}),a.sort((x,S)=>x.unitNumber-S.unitNumber);const N=a.find(x=>x.unitNumber===0);let v=0,A=0,M=0,m=0;a.forEach(x=>{x.unitNumber!==0&&(N&&x.accuracy>N.accuracy&&v++,x.status==="high"&&A++,x.timeSpentSeconds>0&&x.timeSpentSeconds<x.classTimeSpentSeconds&&M++,x.accuracy>=50&&m++)});const b=[{name:"å­¦ä¹ è¿›æ­¥å¾½ç« ",type:"accuracy",level:"progress",description:"æ¯ä¸€æ¬¡çªç ´ï¼Œéƒ½æ˜¯å¯¹è‡ªæˆ‘çš„è¶…è¶Šï¼Œä½ æ˜¯æœ€æ£’çš„è¿›æ­¥å°è¾¾äººï¼",stars:Math.min(5,v)},{name:"åšæŒå°è¾¾äºº",type:"completion",level:"growth",description:"æ»´æ°´ç©¿çŸ³ï¼Œä½ çš„æ¯ä¸€ä»½åšæŒéƒ½åœ¨ä¸ºæˆåŠŸçš„æœªæ¥é“ºè·¯ï¼Œç»§ç»­ä¿æŒï¼",stars:Math.min(5,A)},{name:"æ—¶é—´å°é£ä¾ ",type:"accuracy",level:"potential",description:"çµåŠ¨å¦‚é—ªç”µï¼Œä½ çš„é«˜æ•ˆæ€ç»´è®©å­¦ä¹ å˜å¾—å¦‚æ­¤è½»æ¾ï¼Œä¸ºä½ ç‚¹èµï¼",stars:Math.min(5,M)},{name:"æ»¡åˆ†å†²åˆºæ˜Ÿ",type:"accuracy",level:"master",description:"ç„å‡†ç›®æ ‡ï¼Œå…¨åŠ›ä»¥èµ´ï¼Œä½ çš„ä¸“æ³¨è®©æ¯ä¸€ä¸ªå…³å¡éƒ½å˜å¾—ç®€å•ï¼",stars:Math.min(5,m)}],k=a.reduce((x,S)=>x+S.timeSpentSeconds,0);return{studentName:n,grade:re((j=r[0])==null?void 0:j.package_grade),teacher:((g=r[0])==null?void 0:g.counselor_name)||"è€å¸ˆ",role:o,totalTimeSeconds:k,avgTimePerSession:k/(a.length||1),timeComment:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼",completionBadge:de(0),accuracyBadge:xe(0),htBadges:b,completedUnitsCount:a.filter(x=>x.status==="high").length,units:a,trendAnalysis:rt(a),errorAnalysis:nt(a),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}else{const N=new Map;r.forEach(m=>{const b=parseInt(String(m.level_sequence),10);if(l&&(b<l.min||b>l.max))return;N.has(b)||N.set(b,{unitNumber:b,unitName:`ç¬¬${b}å•å…ƒ`,timeSpentSeconds:0,classTimeSpentSeconds:0,status:"low",statusLabel:"å­¦ä¹ ä¸­",accuracy:0,classAccuracy:0,passRate:0,classPassRate:0,wrongCount:0,analysis:""});const k=N.get(b);k.timeSpentSeconds+=Q(m.first_cost_seconds),k.accuracy=(k.accuracy+B(m.answer_right_rate))/2,k.passRate=(k.passRate+B(m.pass_rate))/2,m.unit_finish_status==="å®Œè¯¾"&&(k.status="high")});const v=Array.from(N.values()).sort((m,b)=>m.unitNumber-b.unitNumber);v.forEach(m=>{const b=s.filter(S=>parseInt(String(S.level_sequence),10)===m.unitNumber),k=b.filter(S=>B(S.answer_right_rate)>0);m.classAccuracy=k.length>0?k.reduce((S,R)=>S+B(R.answer_right_rate),0)/k.length:0;const x=b.filter(S=>B(S.pass_rate)>0);m.classPassRate=x.length>0?x.reduce((S,R)=>S+B(R.pass_rate),0)/x.length:0,m.status==="high"&&(m.analysis=m.accuracy>=m.classAccuracy?"æŒæ¡æ‰å®ï¼Œè¶…è¶Šå¹³å‡":"æ€åº¦è®¤çœŸï¼Œè¯·å·©å›ºé”™é¢˜")});const A=v.reduce((m,b)=>m+b.timeSpentSeconds,0),M=v.reduce((m,b)=>m+b.accuracy,0)/(v.length||1);return{studentName:n,grade:re((i=r[0])==null?void 0:i.package_grade),teacher:((y=r[0])==null?void 0:y.counselor_name)||"è€å¸ˆ",role:o,totalTimeSeconds:A,avgTimePerSession:A/(v.length||1),timeComment:"å­¦ä¹ æ•ˆç‡å¾ˆé«˜ï¼Œè¡¨ç°å‡ºè‰²ã€‚",completionBadge:de(v.filter(m=>m.status==="high").length),accuracyBadge:xe(M),completedUnitsCount:v.filter(m=>m.status==="high").length,units:v,trendAnalysis:lt(v),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}};function rt(s){const n=s.find(a=>a.unitNumber===0),o=s.filter(a=>a.unitNumber>0).sort((a,c)=>a.unitNumber-c.unitNumber);if(o.length===0)return{status:"stable",title:"å¼€å¯æŒ‘æˆ˜",content:"å®è´å·²å‡†å¤‡å°±ç»ªï¼ŒæœŸå¾…å¼€å¯ç²¾å½©çš„æ€ç»´é—¯å…³ä¹‹æ—…ï¼"};const l=o[o.length-1];let r=o.length>=2;for(let a=1;a<o.length;a++)if(o[a].accuracy<=o[a-1].accuracy){r=!1;break}if(r)return{status:"rising",title:"å®Œç¾çš„é˜¶æ¢¯å¼æˆé•¿",content:`å®Œç¾çš„é˜¶æ¢¯å¼æˆé•¿ï¼è¯¾ç¨‹è®¾è®¡çš„æ¯ä¸€æ­¥æŒ‘æˆ˜ï¼Œå­©å­éƒ½æ­¥æ­¥ä¸ºè¥ï¼Œæ­£ç¡®ç‡ä»${o[0].accuracy.toFixed(0)}%ä¸€è·¯ç¨³å®šå‡è‡³${l.accuracy.toFixed(0)}%ã€‚è¿™æ­£æ˜¯ç§‘å­¦å­¦ä¹ è·¯å¾„ä¸å­©å­åŠªåŠ›åŒé¢‘å…±æŒ¯çš„è¯æ˜ã€‚`};if(n){const a=n.accuracy.toFixed(0),c=l.accuracy.toFixed(0),h=Math.abs(l.accuracy-n.accuracy).toFixed(0),j=l.unitNumber;return l.accuracy>n.accuracy?{status:"improving",title:"è¿›æ­¥è·¨è¶Šï¼Œè¡¨ç°äº®çœ¼",content:`å¤ªæ£’äº†ï¼å¯¹æ¯”è¯¾å‰æµ‹ï¼ˆæ­£ç¡®ç‡${a}%ï¼‰ï¼Œå®è´åœ¨ç¬¬${j}è¯¾çš„æ­£ç¡®ç‡å·²æå‡è‡³ ${c}%ï¼Œ${h}ä¸ªç™¾åˆ†ç‚¹çš„è·¨è¶Šæ¸…æ™°å±•ç°äº†è¿›æ­¥ï¼`}:{status:"potential",title:"åšæŒæ€è€ƒï¼Œæ½œåŠ›æ— é™",content:`å€¼å¾—ç‚¹èµï¼ä»è¯¾å‰åˆ°ç¬¬${j}èŠ‚è¯¾çš„å…¨ç¨‹å­¦ä¹ ï¼Œå®è´å±•ç°äº†å‡ºè‰²çš„åšæŒä¸æ€è€ƒä¹ æƒ¯ã€‚é¢å¯¹ä¸æ–­å‡çº§çš„æŒ‘æˆ˜ä»å…´è¶£ç›ç„¶ï¼Œè¿™ä»½ä¸“æ³¨åŠ›æ˜¯æœªæ¥çªç ´çš„æœ€å¤§æ½œåŠ›ã€‚`}}return{status:"stable",title:"ä¿æŒçŠ¶æ€",content:"å±•ç°äº†å‡ºè‰²çš„å­¦ä¹ ä¹ æƒ¯ï¼Œé¢å¯¹æŒ‘æˆ˜æ¯«ä¸é€€ç¼©ã€‚ä¿æŒè¿™ä»½ä¸“æ³¨åŠ›ï¼Œä¸‹ä¸€æ¬¡çªç ´å°±åœ¨çœ¼å‰ï¼"}}function nt(s){const n=s.find(a=>a.unitNumber===0),o=s.filter(a=>a.unitNumber>0).sort((a,c)=>a.unitNumber-c.unitNumber);if(o.length===0)return{status:"stable",title:"å­¦ä¹ è¶³è¿¹",content:"æš‚æ— è®°å½•ï¼ŒæœŸå¾…å®è´ç²¾å½©è¡¨ç°ã€‚"};const l=o[o.length-1];let r=o.length>=2;for(let a=1;a<o.length;a++)if(o[a].wrongCount>=o[a-1].wrongCount){r=!1;break}if(r)return{status:"success",title:"æ­¥æ­¥ä¸ºè¥ï¼Œé£é€Ÿè¿›æ­¥",content:"æ­¥æ­¥ä¸ºè¥ï¼Œé”™é¢˜æŒç»­å‡å°‘ï¼Œå­¦ä¹ ä¹ æƒ¯ä¸æ•ˆæœä¿±ä½³ï¼Œè¿›æ­¥é£é€Ÿï¼"};if(n){if(l.wrongCount<n.wrongCount)return{status:"improving",title:"æˆæ•ˆæ˜¾è‘—",content:"é”™é¢˜æ—¥ç›Šå‡å°‘ï¼Œå¯è§çŸ¥è¯†æŒæ¡è¶Šå‘æ‰å®ç‰¢å›ºï¼"};if(l.wrongCount>n.wrongCount)return{status:"extension",title:"æ€ç»´æ‹“å±•",content:"æŒ‘æˆ˜å‡çº§ï¼Œæ•¢äºå°è¯•å¤æ‚é¢˜ç›®ï¼Œæ­£æ˜¯æ€ç»´æ·±å…¥æ‹“å±•çš„è¡¨ç°ï¼"}}return{status:"stable",title:"ä¸“æ³¨æ”»å…‹",content:"æ¯ä¸€é“é”™é¢˜çš„è®¢æ­£éƒ½æ˜¯ä¸€æ¬¡æ€ç»´çš„é‡å¡‘ï¼Œä¿æŒè¿™ç§è®¤çœŸçš„å­¦ä¹ æ€åº¦ã€‚"}}function lt(s){if(s.length===0)return{status:"stable",title:"ç¨³æ­¥æå‡",content:"ç»§ç»­ä¿æŒè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼"};const n=s[0],o=s[s.length-1],l=s.every(a=>a.accuracy>=a.classAccuracy),r=o.accuracy>n.accuracy;return l&&r?{status:"rising",title:"æŒç»­é¢†å…ˆä¸”ä¸Šå‡",content:"è¡¨ç°ä¼˜ç§€ä¸”æŒç»­è¿›æ­¥ï¼å„å•å…ƒæ­£ç¡®ç‡å‡é«˜äºç­çº§å¹³å‡æ°´å¹³å¹¶ç¨³æ­¥ä¸Šå‡ã€‚"}:l?{status:"above",title:"æ•´ä½“é¢†å…ˆ",content:"æ•´ä½“è¡¨ç°ç¨³å®šé¢†å…ˆï¼åŸºç¡€æ‰å®ï¼Œä¿æŒè¿™ä¸ªèŠ‚å¥ã€‚"}:{status:"stable",title:"ç´§è·Ÿæ­¥ä¼",content:"è¡¨ç°ç¨³å®šï¼Œè·Ÿç´§ç­çº§æ­¥ä¼ï¼Œçªç ´è–„å¼±ç¯èŠ‚æœ‰æœ›å®ç°é¢†å…ˆã€‚"}}const ot=s=>{const n=new Map;return s.forEach(o=>{n.has(o.real_name)||n.set(o.real_name,{name:o.real_name,grade:re(o.package_grade),teacher:o.counselor_name,unitCount:0,lastUnit:0});const l=n.get(o.real_name);l.unitCount++,l.lastUnit=Math.max(l.lastUnit,parseInt(String(o.level_sequence),10))}),Array.from(n.values())},it=({onDataLoaded:s,role:n,onRoleChange:o})=>{const[l,r]=u.useState(null),[a,c]=u.useState(!1),h=i=>{r(null);const y=new FileReader;y.onload=N=>{var v;try{const A=(v=N.target)==null?void 0:v.result,M=Ce(A,{type:"binary"}),m=M.Sheets[M.SheetNames[0]],b=_e.sheet_to_json(m),k=at(b);if(!k.valid)return r(k.error||"æ— æ•ˆæ–‡ä»¶");s(b)}catch{r("è§£ææ–‡ä»¶å‡ºé”™")}},y.readAsBinaryString(i)},j=i=>{i.preventDefault(),c(i.type==="dragenter"||i.type==="dragover")},g=i=>{var y;i.preventDefault(),c(!1),(y=i.dataTransfer.files)!=null&&y[0]&&h(i.dataTransfer.files[0])};return e.jsxs("div",{className:"max-w-2xl mx-auto mt-12 space-y-6",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-2",children:[e.jsxs("button",{onClick:()=>o("counselor"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${n==="counselor"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx($e,{className:"w-5 h-5"})," è¯¾å¯¼æ¨¡å¼"]}),e.jsxs("button",{onClick:()=>o("headteacher"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${n==="headteacher"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx(he,{className:"w-5 h-5"})," ç­ä¸»ä»»æ¨¡å¼"]})]}),e.jsx("div",{className:`p-10 bg-white rounded-[2.5rem] shadow-xl border-4 border-dashed transition-all
          ${a?"border-indigo-400 bg-indigo-50":"border-slate-100"}
          ${l?"border-red-200 bg-red-50":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:g,children:e.jsxs("div",{className:"flex flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:`p-6 rounded-full shadow-sm ${l?"bg-red-100":"bg-indigo-100"}`,children:e.jsx(Ae,{className:`w-12 h-12 ${l?"text-red-500":"text-indigo-500"}`})}),e.jsx("h2",{className:"text-3xl font-black text-slate-800",children:"ä¸Šä¼ å­¦ä¹ æ•°æ® Excel"}),e.jsx("p",{className:"text-slate-400 font-bold max-w-sm",children:"è¯·ä¸Šä¼ ç­çº§å­¦ä¹ è®°å½•è¡¨æ ¼ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ ¹æ®æ‰€é€‰èº«ä»½ç”Ÿæˆç²¾ç¾æŠ¥å‘Š"}),e.jsxs("label",{className:"cursor-pointer bg-slate-800 hover:bg-slate-900 text-white font-black px-12 py-4 rounded-3xl transition-all shadow-xl hover:-translate-y-1 flex items-center gap-2",children:[e.jsx(Me,{className:"w-6 h-6"})," é€‰æ‹©æ–‡ä»¶",e.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:i=>{var y;return((y=i.target.files)==null?void 0:y[0])&&h(i.target.files[0])}})]})]})})]})},ct=({data:s,color:n="#f97316",isZoomed:o=!1,metric:l="accuracy"})=>{const r=l,a=l==="accuracy"?"classAccuracy":"classPassRate",c=l==="accuracy"?"ä½œç­”æ­£ç¡®ç‡":"è¿‡å…³ç‡",h=s.map(g=>({name:g.unitNumber,displayOrder:String(g.unitNumber),fullName:g.unitName,value:g[r],classAverage:g[a]})),j=()=>{if(!o||h.length===0)return[0,100];const g=h.flatMap(N=>[N.value,N.classAverage]).filter(N=>typeof N=="number");if(g.length===0)return[0,100];const i=Math.min(...g);return[Math.max(0,Math.floor(i-5)),100]};return e.jsx("div",{className:"w-full h-full flex flex-col font-sans",children:e.jsx("div",{className:"flex-grow min-h-0",children:e.jsx(Ve,{width:"100%",height:"100%",children:e.jsxs(Ye,{data:h,margin:{top:20,right:30,left:0,bottom:20},children:[e.jsx(Ze,{strokeDasharray:"3 3",vertical:!1,stroke:"#e7e5e4"}),e.jsx(Xe,{dataKey:"displayOrder",tick:{fontSize:12,fill:"#78716c",fontWeight:800},axisLine:!1,tickLine:!1,padding:{left:20,right:20}}),e.jsx(Qe,{domain:j(),tick:{fontSize:12,fill:"#78716c",fontWeight:700},axisLine:!1,tickLine:!1,width:35}),e.jsx(et,{formatter:(g,i)=>[`${g.toFixed(1)}%`,i==="value"?`æˆ‘çš„${c}`:`ç­çº§å¹³å‡${c}`],contentStyle:{borderRadius:"16px",border:`2px solid ${n}`,backgroundColor:"#fff",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",fontFamily:"Nunito, sans-serif",color:"#44403c",fontWeight:"bold"},labelFormatter:g=>`ç¬¬ ${g} å•å…ƒ`,cursor:{stroke:n,strokeWidth:2,strokeDasharray:"4 4"}}),e.jsx(ce,{type:"monotone",dataKey:"classAverage",name:"classAverage",stroke:"#cbd5e1",strokeWidth:4,strokeDasharray:"8 8",dot:{r:0},activeDot:!1}),e.jsx(ce,{connectNulls:!0,type:"monotone",dataKey:"value",name:"value",stroke:n,strokeWidth:5,dot:{r:6,fill:"#fff",stroke:n,strokeWidth:4},activeDot:{r:9,fill:n,stroke:"#fff",strokeWidth:3}})]})})})})},se={default:{id:"default",label:"ç»å…¸æš–é˜³",icon:e.jsx(ee,{className:"w-4 h-4"}),containerClass:"rounded-[3.5rem] border-[6px] shadow-2xl",cardClass:"rounded-[2rem] border-2 shadow-sm",headerClass:"border-b-4",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/confetti.png",colors:{bgMain:"bg-white",textMain:"text-stone-700",textMuted:"text-stone-400",headerBg:"bg-[#FFF8E1]",headerText:"text-amber-800",primary:"bg-amber-400 hover:bg-amber-500 text-white shadow-[0_4px_0_#d97706]",secondary:"bg-white border-2 border-stone-200 text-stone-400 hover:border-red-200 hover:text-red-500",border:"border-amber-100",profileBg:"bg-sky-50",badgesBg:"bg-[#fffbf0]",statsBg:"bg-stone-50",chartBg:"bg-[#fffaf5]",tableHeader:"bg-stone-50 text-stone-500",teacherSection:"bg-sky-50 border-amber-100",rankingHeaderBg:"bg-blue-50 border-blue-100",rankingHighlightRow:"bg-amber-50",rankingBannerBg:"bg-[#ff8a80]",rankingBannerText:"text-white"}},boy:{id:"boy",label:"æ˜Ÿé™…æ¢ç´¢",icon:e.jsx(ae,{className:"w-4 h-4"}),containerClass:"rounded-[3rem] border-[5px] shadow-[0_10px_50px_rgba(59,130,246,0.15)]",cardClass:"rounded-[2.5rem] border-2 border-b-4",headerClass:"border-b-4 border-blue-900/10",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/cubes.png",colors:{bgMain:"bg-slate-50",textMain:"text-slate-800",textMuted:"text-slate-400",headerBg:"bg-blue-100",headerText:"text-blue-900",primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-[0_4px_0_#1e3a8a]",secondary:"bg-white border-2 border-slate-300 text-slate-500 hover:border-blue-500 hover:text-blue-600",border:"border-blue-200",profileBg:"bg-white",badgesBg:"bg-gradient-to-br from-blue-50 to-slate-100",statsBg:"bg-slate-100",chartBg:"bg-white",tableHeader:"bg-slate-200 text-slate-600 uppercase tracking-wider",teacherSection:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white border-none",rankingHeaderBg:"bg-blue-100 border-blue-200",rankingHighlightRow:"bg-blue-50",rankingBannerBg:"bg-blue-500",rankingBannerText:"text-white"}},girl:{id:"girl",label:"æ¢¦å¹»äº‘æœµ",icon:e.jsx(ze,{className:"w-4 h-4"}),containerClass:"rounded-[4rem] border-[8px] border-double shadow-2xl ring-8 ring-rose-50",cardClass:"rounded-[2.5rem] border-2 border-dashed shadow-[4px_4px_0px_rgba(253,164,175,0.3)]",headerClass:"border-b-[3px] border-dashed",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/hearts.png",colors:{bgMain:"bg-[#fffcfd]",textMain:"text-stone-600",textMuted:"text-rose-200",headerBg:"bg-rose-50",headerText:"text-stone-700",primary:"bg-rose-200 hover:bg-rose-300 text-stone-700 shadow-[0_4px_0_#fda4af]",secondary:"bg-white/80 border-2 border-rose-100 text-rose-300 hover:bg-white",border:"border-rose-100",profileBg:"bg-white/60 backdrop-blur-sm",badgesBg:"bg-gradient-to-b from-rose-50/20 to-white/50",statsBg:"bg-rose-50/40",chartBg:"bg-white/60",tableHeader:"bg-rose-50 text-rose-300",teacherSection:"bg-stone-50 border-rose-100",rankingHeaderBg:"bg-stone-50 border-stone-100",rankingHighlightRow:"bg-rose-50",rankingBannerBg:"bg-stone-400",rankingBannerText:"text-white"}}},dt=(s,n,o)=>{const l=new Map;s.forEach(a=>{const c=o==="headteacher",h=parseInt(String(a.level_sequence),10),j=parseInt(String(a.unit_sequence),10);if(c){if(h!==n.max)return}else if(isNaN(h)||h<n.min||h>n.max)return;l.has(a.real_name)||l.set(a.real_name,{accuracies:{},totalScore:0,avgAccuracy:0,count:0,id:a.user_id});const g=l.get(a.real_name),i=B(a.answer_right_rate);g.accuracies[j]=i});const r=Array.from(l.entries()).map(([a,c])=>{let h=0,j=0,g=0;return o==="headteacher"?[0,1,2,3,4,5].forEach(i=>{c.accuracies[i]!==void 0&&(h+=c.accuracies[i])}):Object.values(c.accuracies).forEach(i=>{j+=i,g++}),{name:a,userId:c.id,accuracies:c.accuracies,totalScore:Math.round(h),avgAccuracy:g>0?j/g:0,rank:0}});return o==="headteacher"?r.sort((a,c)=>c.totalScore-a.totalScore):r.sort((a,c)=>c.avgAccuracy-a.avgAccuracy),r.forEach((a,c)=>a.rank=c+1),{rankings:r,total:r.length}},ue=[0,1,2,3,4,5],xt=({data:s,rawData:n,onBack:o,availableUnits:l,currentRange:r,onRangeChange:a,currentTheme:c,onThemeChange:h,selectedCurriculumKey:j,setSelectedCurriculumKey:g,onSwitchStudentById:i,isChartZoomed:y,onToggleZoom:N,trendMetric:v,onToggleMetric:A,customUnitNames:M,onUpdateCustomUnitNames:m,customAssociations:b,onUpdateCustomAssociations:k,customKPCounts:x,onUpdateCustomKPCounts:S,customErrorCounts:R,onUpdateCustomErrorCounts:H})=>{var ne;const _=se[c],p=_.colors,d=s.role==="headteacher",[O,W]=u.useState(""),[L,D]=u.useState(!1),[C,U]=u.useState(M.join(`
`)),[Z,te]=u.useState(b.join(`
`)),[z,f]=u.useState(x.join(`
`)),[$,P]=u.useState(R.join(`
`)),J=be[j]||[],{rankings:F,total:V}=u.useMemo(()=>dt(n,r,s.role),[n,r,s.role]),E=F.find(t=>t.name===s.studentName),Y=u.useMemo(()=>{const t=F.findIndex(w=>w.name===s.studentName);return t===-1?[]:F.slice(Math.max(0,t-5),Math.min(F.length,t+6))},[F,s.studentName]),Ne=()=>{m(C.split(`
`).map(t=>t.trim())),d||(k(Z.split(`
`).map(t=>t.trim())),S(z.split(`
`).map(t=>t.trim())),H($.split(`
`).map(t=>t.trim()))),D(!1)},we=t=>{if(t===0)return"è¯¾å‰æµ‹";const w=M[t-1];return w&&w.trim()?w:d&&t>=1&&t<=5?J[t-1]||`ç¬¬${t}è®²`:d?`ç¬¬${t}è®²`:`ç¬¬${t}å•å…ƒ`},je=t=>d||t===0?"":b[t-1]||"",G=u.useMemo(()=>s.units.map(t=>{const w=we(t.unitNumber),T=t.status==="low"?`ã€${w}ã€‘ç­‰ä½ æŒ‘æˆ˜`:t.analysis;return{...t,unitName:w,association:je(t.unitNumber),analysis:T}}),[s.units,d,J,M,b]),X=u.useMemo(()=>{if(d||G.length!==4)return null;let t=0,w=0;const T=[],I=[];return G.forEach(K=>{const le=K.unitNumber-1;t+=parseInt(x[le]||"0"),w+=parseInt(R[le]||"0"),K.accuracy>K.classAccuracy?T.push(K.unitName):I.push(K.unitName)}),{totalKPs:t,totalErrors:w,totalMinutes:Math.ceil(s.totalTimeSeconds/60),highPerformersJoined:T.join("ã€"),lowPerformersJoined:I.join("ã€")}},[d,G,x,R,s.totalTimeSeconds]),ye=t=>{if(!t)return null;const w=t.includes("é«˜é¢‘"),T=t.includes("é‡ç‚¹"),I=t.includes("æ‹“å±•")||t.includes("æ€ç»´");return w?e.jsxs("span",{className:"px-2 py-1 rounded bg-rose-50 text-rose-500 border border-rose-200 text-[10px] font-black shadow-[2px_2px_0_rgba(244,63,94,0.1)]",children:["ğŸ”¥ ",t]}):T?e.jsx("span",{className:"px-2 py-1 rounded bg-indigo-50 text-indigo-500 border border-indigo-100 text-[10px] font-black",children:t}):I?e.jsxs("span",{className:"px-2 py-1 rounded bg-emerald-50 text-emerald-500 border border-emerald-100 text-[10px] font-black",children:["ğŸ’¡ ",t]}):e.jsx("span",{className:"px-2 py-1 rounded bg-slate-50 text-slate-400 text-[10px] font-bold",children:t})},ve=()=>{if(!E)return"ç»§ç»­åŠªåŠ›ï¼Œäº‰å–æ›´å¥½çš„æˆç»©ï¼";const{rank:t}=E,w=t/(V||1);return t===1?"ç‹¬å é³Œå¤´ï¼ä½ æ˜¯å…¨ç­æœ€é—ªäº®çš„å­¦ä¹ æ˜æ˜Ÿï¼Œå±•ç°äº†éå‡¡çš„æŒæ¡åŠ›ï¼":t<=3?"ååˆ—å‰èŒ…ï¼ä¼˜ç§€çš„å­¦ä¹ ä¹ æƒ¯æ˜¯ä½ æˆåŠŸçš„åŸºçŸ³ï¼Œä¿æŒè¿™ä»½å†²åŠ²ï¼":w<=.2?"è¡¨ç°ä¼˜å¼‚ï¼å·²è¿›å…¥ç­çº§ç¬¬ä¸€æ¢¯é˜Ÿï¼Œç»§ç»­ä¿æŒç¨³å¥çš„æ­¥ä¼ï¼Œå†²åˆºå·…å³°ï¼":w<=.5?"è¿›æ­¥æ˜¾è‘—ï¼ä½ æ­£èµ°åœ¨ç¨³æ­¥æå‡çš„é˜¶æ¢¯ä¸Šï¼Œç¦»å°–å­ç”Ÿè¡Œåˆ—ä»…ä¸€æ­¥ä¹‹é¥ï¼":"æ½œåŠ›æ— é™ï¼ä¿æŒä¸“æ³¨ä¸è€å¿ƒï¼Œæ¯ä¸€ä»½æ±—æ°´éƒ½ä¼šåœ¨æœªæ¥çš„è€ƒè¯•ä¸­å¼€å‡ºç¿çƒ‚ä¹‹èŠ±ï¼"};return e.jsxs("div",{className:`max-w-6xl mx-auto my-6 font-sans ${p.textMain}`,children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-center px-4 gap-4 print:hidden",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{onClick:o,className:"bg-white px-6 py-2.5 rounded-full border-2 border-slate-100 shadow-sm font-black flex items-center gap-2 transition-all hover:scale-105 active:scale-95",children:[e.jsx(Te,{className:"w-5 h-5"}),"åˆ—è¡¨"]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),i(O),W("")},className:"relative group",children:[e.jsx(ge,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300 group-focus-within:text-indigo-400 transition-colors"}),e.jsx("input",{type:"text",value:O,onChange:t=>W(t.target.value),placeholder:"IDåˆ‡æ¢",className:"bg-white pl-10 pr-4 py-2.5 rounded-full border-2 border-slate-100 shadow-sm outline-none focus:border-indigo-100 font-bold text-sm w-32"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-center",children:[e.jsxs("button",{onClick:()=>D(!L),className:`bg-white px-4 py-2 rounded-full border-2 shadow-sm font-black text-xs flex items-center gap-2 transition-all ${L?"border-indigo-400 text-indigo-600":"border-slate-100 text-slate-400 hover:border-indigo-100"}`,children:[e.jsx(oe,{className:"w-4 h-4"})," è®¾ç½®è¯¾ç¨‹ä¿¡æ¯"]}),e.jsx("div",{className:"bg-white p-1 rounded-full border-2 border-slate-100 shadow-sm flex",children:Object.keys(se).map(t=>e.jsx("button",{onClick:()=>h(t),className:`px-4 py-1.5 rounded-full text-xs font-black transition-all ${c===t?"bg-slate-800 text-white shadow-md":"text-slate-400"}`,children:se[t].label},t))}),!d&&e.jsxs("div",{className:"bg-white px-4 py-2 rounded-full border-2 border-slate-100 shadow-sm flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-slate-300"}),e.jsx("select",{value:r.min,onChange:t=>a(parseInt(t.target.value),r.max),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:l.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))}),e.jsx("span",{className:"text-slate-200",children:"~"}),e.jsx("select",{value:r.max,onChange:t=>a(r.min,parseInt(t.target.value)),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:l.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))})]}),e.jsxs("button",{onClick:()=>window.print(),className:`px-8 py-2.5 rounded-full font-black flex items-center gap-2 transition-all active:translate-y-1 ${p.primary}`,children:[e.jsx(Be,{className:"w-5 h-5"}),"æ‰“å°/å¯¼å‡º"]})]})]}),L&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 print:hidden",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-black text-indigo-900 flex items-center gap-3",children:[e.jsx(oe,{className:"w-8 h-8"})," æ‰‹åŠ¨æ‰¹é‡è®¾ç½®è¯¾ç¨‹ä¿¡æ¯"]}),e.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"æ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªå•å…ƒé¡ºåºã€‚è¯·ç¡®ä¿å„åˆ—è¡Œæ•°å¯¹é½ã€‚"})]}),e.jsx("button",{onClick:()=>D(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(Ie,{className:"w-8 h-8 text-slate-300"})})]}),e.jsxs("div",{className:`flex-grow overflow-y-auto p-8 grid ${d?"grid-cols-1":"grid-cols-4"} gap-6`,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"å•å…ƒåç§°"}),e.jsx("textarea",{value:C,onChange:t=>U(t.target.value),placeholder:"ç¬¬ä¸€è¡Œå¯¹åº”ç¬¬1å•å…ƒ/è®²...",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),!d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"å­¦ä¹ å…³è”"}),e.jsx("textarea",{value:Z,onChange:t=>te(t.target.value),placeholder:"é«˜é¢‘è€ƒç‚¹/æ‹“å±•å†…å®¹...",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"çŸ¥è¯†ç‚¹æ•°é‡"}),e.jsx("textarea",{value:z,onChange:t=>f(t.target.value),placeholder:"12",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"æ˜“é”™ç‚¹æ•°é‡"}),e.jsx("textarea",{value:$,onChange:t=>P(t.target.value),placeholder:"3",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]})]})]}),e.jsxs("div",{className:"p-8 border-t bg-slate-50/50 flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>D(!1),className:"px-8 py-3 rounded-full font-black text-slate-400 hover:text-slate-600 transition-colors",children:"æ”¾å¼ƒä¿®æ”¹"}),e.jsxs("button",{onClick:Ne,className:"px-12 py-3 bg-indigo-600 text-white rounded-full font-black shadow-lg hover:bg-indigo-700 transition-all flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"ç¡®è®¤å¹¶åŒæ­¥"]})]})]})}),e.jsxs("div",{className:`${p.bgMain} ${_.containerClass} ${p.border} overflow-hidden relative print:shadow-none print:border-none print:rounded-none transition-all duration-700 mx-auto print:w-full`,children:[e.jsx("div",{className:`${p.headerBg} py-12 text-center relative border-b-4 ${p.border}`,children:e.jsxs("h1",{className:`text-4xl font-black ${p.headerText} tracking-tight drop-shadow-sm flex items-center justify-center gap-3`,children:[c==="boy"?e.jsx(ae,{className:"w-10 h-10 animate-pulse"}):e.jsx(Le,{className:"w-10 h-10 text-yellow-300 fill-current"}),s.studentName," ",d?"ä¸“å±å­¦ä¹ æŠ¥å‘Š":`${r.min}-${r.max}å•å…ƒ å­¦ä¹ æŠ¥å‘Š`]})}),e.jsxs("div",{className:`flex flex-col md:flex-row border-b-4 ${p.border}`,children:[e.jsxs("div",{className:`w-full md:w-1/3 ${p.profileBg} p-10 border-b-4 md:border-b-0 md:border-r-4 ${p.border} flex flex-col justify-center`,children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:`w-16 h-16 rounded-3xl flex items-center justify-center border-4 shadow-sm ${c==="boy"?"bg-blue-600 text-white border-blue-200":"bg-rose-100 text-stone-500 border-white"}`,children:e.jsx(Ee,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-2xl",children:"å­¦å‘˜æ¡£æ¡ˆ"}),e.jsx("p",{className:"text-xs opacity-40 font-bold uppercase tracking-widest",children:"Profile Card"})]})]}),e.jsxs("div",{className:`${_.cardClass} bg-white p-8 space-y-6`,children:[e.jsxs("div",{className:"flex justify-between border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40",children:"å§“å"}),e.jsx("span",{className:"font-black text-xl",children:s.studentName})]}),e.jsxs("div",{className:"flex justify-between border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40",children:"å¹´çº§"}),e.jsx("span",{className:"px-4 py-1 rounded-full bg-slate-100 font-bold text-sm",children:s.grade})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-bold opacity-40",children:"è€å¸ˆ"}),e.jsx("span",{className:"font-bold",children:s.teacher})]})]})]}),e.jsxs("div",{className:`w-full md:w-2/3 ${p.badgesBg} p-10`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(Oe,{className:"w-8 h-8 text-amber-400"}),e.jsx("h3",{className:"text-2xl font-black",children:d?"å­¦ä¹ æˆé•¿å‹‹ç« ":"è£èª‰æˆå°±"})]}),d?e.jsx("div",{className:"grid grid-cols-2 gap-6",children:(ne=s.htBadges)==null?void 0:ne.map(t=>e.jsxs("div",{className:`${_.cardClass} bg-white/80 backdrop-blur-sm p-4 flex flex-col items-center justify-center shadow-sm`,children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center mb-2 shadow-sm ${c==="boy"?"bg-blue-600 text-white":"bg-rose-50 text-rose-300"}`,children:t.level==="progress"?e.jsx(ie,{className:"w-6 h-6"}):t.level==="potential"?e.jsx(ae,{className:"w-6 h-6"}):e.jsx(ee,{className:"w-6 h-6"})}),e.jsx("h4",{className:"font-black text-sm mb-1",children:t.name}),e.jsx("div",{className:"flex gap-0.5 mb-2",children:[...Array(5)].map((w,T)=>e.jsx(ee,{className:`w-3.5 h-3.5 ${T<(t.stars||0)?"text-yellow-400 fill-yellow-400":"text-slate-200 fill-slate-100"}`},T))}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400/80 text-center leading-tight italic",children:["â€œ",t.description,"â€"]})]},t.name))}):e.jsxs("div",{className:"flex gap-10",children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform rotate-3 mb-4 ${c==="boy"?"bg-amber-400 border-4 border-white":"bg-rose-50 border-rose-100 border-2"}`,children:e.jsx(ee,{className:`w-12 h-12 ${c==="boy"?"text-white":"text-rose-300"}`})}),e.jsx("p",{className:"font-black text-lg mb-2",children:s.completionBadge.name}),e.jsx("div",{className:`${_.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.completionBadge.description})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform -rotate-3 mb-4 ${c==="boy"?"bg-blue-600 border-4 border-white":"bg-amber-50 border-amber-100 border-2"}`,children:e.jsx(Ue,{className:"w-12 h-12 text-white"})}),e.jsx("p",{className:"font-black text-lg mb-2",children:s.accuracyBadge.name}),e.jsx("div",{className:`${_.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.accuracyBadge.description})]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:`w-full ${d?"lg:w-[45%]":"lg:w-[55%]"} border-b-4 lg:border-b-0 lg:border-r-4 ${p.border} bg-white p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3 whitespace-nowrap",children:[e.jsx(Pe,{className:"w-8 h-8 text-indigo-500"}),d?`${s.studentName}åŒå­¦ å­¦ä¹ è®°å½•`:"å­¦ä¹ é—¯å…³è®°å½•"]}),e.jsx("div",{className:"mt-2 px-6 py-2 bg-indigo-50 rounded-full text-indigo-600 font-black text-xs w-fit",children:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼"})]}),d&&s.errorAnalysis&&e.jsx("div",{className:"mb-6 p-5 bg-rose-50 rounded-[1.5rem] border-2 border-rose-100 shadow-sm animate-in slide-in-from-left duration-500",children:e.jsxs("p",{className:"text-xs font-bold text-rose-800/80 leading-relaxed italic",children:["â€œ",s.errorAnalysis.content,"â€"]})}),e.jsx("div",{className:`${_.cardClass} border-2 overflow-hidden flex-grow`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:p.tableHeader,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left",children:"å•å…ƒå†…å®¹"}),!d&&e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ å…³è”"}),e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ æ—¶é•¿"}),!d&&e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ åˆ†æ"}),d&&e.jsx("th",{className:"px-4 py-4 text-right",children:"é”™è¯¯ç»Ÿè®¡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:G.map((t,w)=>{const T=Math.max(...G.map(K=>K.wrongCount),1),I=t.wrongCount/T*80;return e.jsxs("tr",{className:`transition-colors ${w%2===0?"bg-white":"bg-slate-50/50"} hover:bg-slate-100`,children:[e.jsx("td",{className:"px-4 py-5 font-black whitespace-nowrap text-xs",children:t.unitName}),!d&&e.jsx("td",{className:"px-4 py-5 text-center",children:ye(t.association)}),e.jsx("td",{className:"px-4 py-5 text-center font-bold opacity-50 text-xs",children:tt(t.timeSpentSeconds)}),!d&&e.jsx("td",{className:`px-4 py-5 text-center font-black text-[11px] whitespace-nowrap ${t.status==="low"?"text-slate-300":"text-indigo-500"}`,children:t.analysis}),d&&e.jsx("td",{className:"px-4 py-5 text-right min-w-[120px]",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("div",{className:"h-2 bg-rose-100 rounded-full overflow-hidden w-20 flex-shrink-0",children:e.jsx("div",{className:"h-full bg-rose-400 rounded-full",style:{width:`${I}%`}})}),e.jsx("span",{className:"font-black text-rose-400 text-xs w-6 text-right",children:t.wrongCount})]})})]},t.unitNumber)})})]})})}),!d&&X&&e.jsx("div",{className:"mt-8 space-y-6 animate-in fade-in duration-500",children:e.jsxs("div",{className:`${_.cardClass} bg-indigo-600 text-white p-8 relative overflow-hidden shadow-xl`,children:[e.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"}),e.jsxs("h4",{className:"text-xl font-black flex items-center gap-3 mb-6",children:[e.jsx(De,{className:"w-6 h-6"})," ğŸ“ˆ å­¦ä¹ é‡Œç¨‹ç¢‘"]}),e.jsxs("p",{className:"text-sm font-bold leading-loose opacity-90",children:["æœ¬æœˆä½ ç´¯è®¡å­¦ä¹  ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:X.totalMinutes})," åˆ†é’Ÿï¼Œæ¯ä¸€åˆ†é’Ÿï¼Œéƒ½åœ¨æŠŠè–„å¼±å˜æˆå¼ºé¡¹ã€‚å®Œæˆã€",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:X.totalKPs}),"ä¸ªçŸ¥è¯†ç‚¹ã€‘ç›¸å½“äºæ”»å…‹äº† ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:X.totalErrors}),"ä¸ªé«˜é¢‘æ˜“é”™ç‚¹ï¼Œæ‰«æ¸…å¹´çº§çŸ¥è¯†ç›²åŒºã€‚"]})]})})]}),e.jsxs("div",{className:`w-full ${d?"lg:w-[55%]":"lg:w-[45%]"} ${p.chartBg} p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3",children:[e.jsx(Fe,{className:"w-8 h-8 text-amber-500"}),d?`${s.studentName}åŒå­¦ æ­£ç¡®ç‡è¶‹åŠ¿`:"è¶‹åŠ¿åˆ†æ"]}),e.jsxs("div",{className:"flex items-center gap-2 print:hidden",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>A("accuracy"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="accuracy"?"bg-white shadow-sm text-indigo-600":"text-slate-400"}`,children:"æ­£ç¡®ç‡"}),e.jsx("button",{onClick:()=>A("passRate"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="passRate"?"bg-white shadow-sm text-indigo-600":"text-slate-400"}`,children:"è¿‡å…³ç‡"})]}),d&&e.jsx("button",{onClick:N,className:`p-2 rounded-xl border-2 transition-all ${y?"bg-amber-100 border-amber-300 text-amber-700":"bg-white text-slate-400"}`,children:y?e.jsx(qe,{className:"w-4 h-4"}):e.jsx(He,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:`${_.cardClass} bg-white p-6 h-[400px] mb-8 relative shadow-md border-indigo-50 border-4`,children:e.jsx(ct,{data:G,color:d?"#818cf8":"#f97316",isZoomed:d&&y,metric:v})}),e.jsxs("div",{className:`${_.cardClass} bg-white p-6 shadow-sm border-2 ${p.border}`,children:[e.jsxs("h4",{className:`text-lg font-black mb-4 flex items-center gap-2 ${p.headerText}`,children:[e.jsx(ie,{className:"w-5 h-5 text-yellow-400 fill-current"}),s.trendAnalysis.title]}),e.jsxs("p",{className:"font-bold text-sm leading-relaxed opacity-80 italic",children:["â€œ",s.trendAnalysis.content,"â€"]})]})]})]}),e.jsx("div",{className:"bg-white p-10",children:e.jsxs("div",{className:`${_.cardClass} border-2 ${p.border} overflow-hidden shadow-sm`,children:[e.jsxs("div",{className:`${p.rankingHeaderBg} p-6 border-b flex justify-between items-center`,children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3",children:[e.jsx(Ke,{className:"w-8 h-8 text-stone-400"}),"æ­£ç¡®ç‡æ’å"]}),e.jsxs("span",{className:"font-bold text-xs opacity-40",children:["å…±æœ‰ ",V," åå­¦å‘˜å‚ä¸ç»Ÿè®¡"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50/80 text-slate-400 font-bold text-[10px] uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left w-20",children:"åæ¬¡"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"å§“å"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"å­¦å· (UID)"}),d&&ue.map(t=>e.jsx("th",{className:`px-2 py-4 text-center whitespace-nowrap ${t===0?"bg-amber-50 text-amber-600 border-r-2 border-amber-100":""}`,children:t===0?"è¯¾å‰æµ‹":`L${t}`},t)),e.jsx("th",{className:"px-6 py-4 text-right",children:d?"ç»¼åˆå¾—åˆ†":"å¹³å‡æ­£ç¡®ç‡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:Y.map(t=>{const w=t.name===s.studentName,T=w?t.name:(t.name.charAt(0)+"x".repeat(Math.min(t.name.length-1,1))).slice(0,4);return e.jsxs("tr",{className:`${w?p.rankingHighlightRow:"hover:bg-slate-50/50"} transition-all`,children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("span",{className:`w-9 h-9 rounded-2xl flex items-center justify-center font-black ${t.rank<=3?"bg-amber-100 text-amber-600":"bg-slate-100 text-slate-400"} ${w?"ring-4 ring-amber-400/20":""}`,children:t.rank})}),e.jsxs("td",{className:`px-6 py-5 font-black text-base ${w?"text-amber-600":"opacity-70"}`,children:[T,w&&e.jsx("span",{className:"ml-2 text-[10px] bg-amber-400 text-white px-2 py-0.5 rounded-full font-sans uppercase",children:"ME"})]}),e.jsx("td",{className:"px-6 py-5 font-black text-sm font-mono opacity-50",children:t.userId}),d&&ue.map(I=>e.jsx("td",{className:`px-2 py-5 text-center font-bold text-[10px] ${I===0?"bg-amber-50/30 border-r-2 border-amber-100/50":""} ${t.accuracies[I]!==void 0?"text-slate-600":"text-slate-200"}`,children:t.accuracies[I]!==void 0?`${t.accuracies[I].toFixed(0)}%`:"-"},I)),e.jsx("td",{className:"px-6 py-5 text-right font-black text-lg whitespace-nowrap",children:d?t.totalScore:`${t.avgAccuracy.toFixed(1)}%`})]},t.userId)})})]})}),e.jsx("div",{className:`${p.rankingBannerBg} ${p.rankingBannerText} p-8 text-center font-black text-sm italic leading-relaxed`,children:ve()})]})}),e.jsx("div",{className:`${p.teacherSection} p-12 text-center relative overflow-hidden`,children:e.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-6 opacity-40"}),e.jsx("p",{className:"text-2xl font-black italic mb-4 opacity-90 leading-snug",children:"â€œ å­¦ä¹ ä¸ä»…æ˜¯åˆ†æ•°çš„ç´¯ç§¯ï¼Œæ›´æ˜¯æ€ç»´çš„ç ´å£³è€Œå‡ºã€‚äº²çˆ±çš„å®¶é•¿ï¼Œå®è´æ­£åœ¨ç”¨æ¯ä¸€ä¸ªç™¾åˆ†ç‚¹çš„è¿›æ­¥ï¼Œä¹¦å†™å±äºè‡ªå·±çš„æœªæ¥ï¼è®©æˆ‘ä»¬å…±åŒå‘µæŠ¤è¿™ä»½æˆé•¿ã€‚ â€"}),e.jsxs("p",{className:"font-bold opacity-60",children:["â€” æ‚¨çš„è¾…å¯¼è€å¸ˆ ",s.teacher]})]})})]})]})},mt=({data:s,onSelectStudent:n,onReupload:o})=>{const[l,r]=u.useState(""),[a,c]=u.useState("all"),h=u.useMemo(()=>ot(s),[s]),j=u.useMemo(()=>{const i=new Set(h.map(y=>y.grade));return Array.from(i).filter(Boolean)},[h]),g=u.useMemo(()=>h.filter(i=>{const y=i.name.toLowerCase().includes(l.toLowerCase())||i.teacher.toLowerCase().includes(l.toLowerCase()),N=a==="all"||i.grade===a;return y&&N}),[h,l,a]);return e.jsxs("div",{className:"max-w-5xl mx-auto my-8 space-y-6 font-sans",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-indigo-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-xl text-indigo-600",children:e.jsx(he,{className:"w-6 h-6"})}),"å­¦ç”Ÿæ•°æ®åˆ—è¡¨"]}),e.jsxs("p",{className:"text-indigo-400 font-medium mt-2 ml-1",children:["å…±å¯¼å…¥ ",h.length," åå­¦ç”Ÿï¼Œ",s.length," æ¡å­¦ä¹ è®°å½•"]})]}),e.jsx("button",{onClick:o,className:"text-sm font-bold text-gray-400 hover:text-red-500 underline transition-colors",children:"é‡æ–°ä¸Šä¼ æ–‡ä»¶"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-indigo-50/50 p-2 rounded-2xl border border-indigo-100",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsx("input",{type:"text",placeholder:"æœç´¢å§“åæˆ–è¾…å¯¼è€å¸ˆ...",value:l,onChange:i=>r(i.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 placeholder-indigo-300 focus:outline-none focus:ring-0 font-medium transition-all"})]}),e.jsxs("div",{className:"relative min-w-[200px]",children:[e.jsx(pe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsxs("select",{value:a,onChange:i=>c(i.target.value),className:"w-full pl-12 pr-10 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 font-medium appearance-none focus:outline-none focus:ring-0 cursor-pointer transition-all",children:[e.jsx("option",{value:"all",children:"æ‰€æœ‰å¹´çº§"}),j.map(i=>e.jsx("option",{value:i,children:i},i))]}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-indigo-50/50 border-b border-indigo-100 text-indigo-400 uppercase font-bold text-xs tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-5",children:"å­¦ç”Ÿå§“å"}),e.jsx("th",{className:"px-6 py-5",children:"å¹´çº§"}),e.jsx("th",{className:"px-6 py-5",children:"è¾…å¯¼è€å¸ˆ"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"è®°å½•æ•°"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"æœ€æ–°è¿›åº¦"}),e.jsx("th",{className:"px-6 py-5 text-right",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"divide-y divide-indigo-50",children:g.length>0?g.map(i=>e.jsxs("tr",{className:"hover:bg-indigo-50/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("div",{className:"font-bold text-lg text-indigo-900",children:i.name})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-600",children:[e.jsx(Ge,{className:"w-3.5 h-3.5"}),i.grade]})}),e.jsx("td",{className:"px-6 py-5 font-medium text-gray-600",children:i.teacher}),e.jsx("td",{className:"px-6 py-5 text-center font-bold text-indigo-300",children:i.unitCount}),e.jsxs("td",{className:"px-6 py-5 text-center font-medium text-gray-500",children:["ç¬¬ ",i.lastUnit," å•å…ƒ"]}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsxs("button",{onClick:()=>n(i.name),className:"inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-xs px-5 py-2.5 rounded-full transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:["ç”ŸæˆæŠ¥å‘Š",e.jsx(Je,{className:"w-3.5 h-3.5"})]})})]},i.name)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-400",children:[e.jsx("div",{className:"text-4xl",children:"ğŸ¤”"}),e.jsx("div",{className:"font-medium",children:"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­¦ç”Ÿæ•°æ®"})]})})})})]})}),e.jsx("div",{className:"bg-indigo-50/30 px-6 py-4 border-t border-indigo-100 text-xs font-bold text-indigo-300 flex justify-between",children:e.jsxs("span",{children:["æ˜¾ç¤º ",g.length," / ",h.length," ä½å­¦ç”Ÿ"]})})]})]})},q={UNIT_NAMES:"xueqiu_custom_unit_names",ASSOCIATIONS:"xueqiu_custom_associations",KP_COUNTS:"xueqiu_custom_kp_counts",ERROR_COUNTS:"xueqiu_custom_error_counts"};function ut(){const[s,n]=u.useState("upload"),[o,l]=u.useState("counselor"),[r,a]=u.useState([]),[c,h]=u.useState(null),[j,g]=u.useState(null),[i,y]=u.useState([]),[N,v]=u.useState({min:1,max:1}),[A,M]=u.useState("default"),[m,b]=u.useState(Object.keys(be)[0]),[k,x]=u.useState(!1),[S,R]=u.useState("accuracy"),[H,_]=u.useState(()=>{const f=localStorage.getItem(q.UNIT_NAMES);return f?JSON.parse(f):[]}),[p,d]=u.useState(()=>{const f=localStorage.getItem(q.ASSOCIATIONS);return f?JSON.parse(f):[]}),[O,W]=u.useState(()=>{const f=localStorage.getItem(q.KP_COUNTS);return f?JSON.parse(f):[]}),[L,D]=u.useState(()=>{const f=localStorage.getItem(q.ERROR_COUNTS);return f?JSON.parse(f):[]});u.useEffect(()=>{localStorage.setItem(q.UNIT_NAMES,JSON.stringify(H)),localStorage.setItem(q.ASSOCIATIONS,JSON.stringify(p)),localStorage.setItem(q.KP_COUNTS,JSON.stringify(O)),localStorage.setItem(q.ERROR_COUNTS,JSON.stringify(L))},[H,p,O,L]);const C=f=>{a(f),n("list")},U=f=>{const $=st(r,f);if($.length===0)return alert("è¯¥å­¦ç”Ÿæ²¡æœ‰æœ‰æ•ˆæ•°æ®");const P=$[0],J=$[$.length-1];y($),v({min:P,max:J}),g(f);const F=r.find(E=>E.real_name===f);if(F){const E=F.package_grade||"",Y=E.toLowerCase().includes("one")?"ä¸€å¹´çº§":E.toLowerCase().includes("two")?"äºŒå¹´çº§":E.toLowerCase().includes("three")?"ä¸‰å¹´çº§":E.toLowerCase().includes("four")?"å››å¹´çº§":E.toLowerCase().includes("five")?"äº”å¹´çº§":E.toLowerCase().includes("six")?"å…­å¹´çº§":"";Y&&!m.startsWith(Y)&&b(Y)}const V=me(r,f,o,{min:P,max:J});V&&(h(V),n("report"))},Z=f=>{const $=r.find(P=>String(P.user_id)===String(f));$?U($.real_name):alert(`æœªæ‰¾åˆ° ID ä¸º ${f} çš„å­¦å‘˜`)},te=(f,$)=>{if(!j)return;v({min:f,max:$});const P=me(r,j,o,{min:f,max:$});P&&h(P)},z=()=>{a([]),h(null),g(null),n("upload")};return e.jsxs("div",{className:"min-h-screen pb-10 bg-slate-50 font-sans",children:[e.jsx("header",{className:"bg-white border-b-4 border-indigo-100 py-4 mb-8 shadow-sm print:hidden",children:e.jsx("div",{className:"container mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2",children:[e.jsx("h1",{className:"text-2xl font-black text-indigo-600 flex items-center gap-2 cursor-pointer",onClick:z,children:"ğŸ“ å­¦æƒ…åé¦ˆç”Ÿæˆå™¨"}),e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"ä½¿ç”¨é—®é¢˜å¯ç•™è¨€sundong@xueqiulearning.com"})]})})}),e.jsxs("main",{className:"container mx-auto px-4",children:[s==="upload"&&e.jsx(it,{onDataLoaded:C,role:o,onRoleChange:l}),s==="list"&&e.jsx(mt,{data:r,onSelectStudent:U,onReupload:z}),s==="report"&&c&&e.jsx(xt,{data:c,rawData:r,onReset:z,onBack:()=>n("list"),availableUnits:i,currentRange:N,onRangeChange:te,currentTheme:A,onThemeChange:M,selectedCurriculumKey:m,setSelectedCurriculumKey:b,onSwitchStudentById:Z,isChartZoomed:k,onToggleZoom:()=>x(!k),trendMetric:S,onToggleMetric:f=>R(f),customUnitNames:H,onUpdateCustomUnitNames:_,customAssociations:p,onUpdateCustomAssociations:d,customKPCounts:O,onUpdateCustomKPCounts:W,customErrorCounts:L,onUpdateCustomErrorCounts:D})]})]})}const fe=document.getElementById("root");if(!fe)throw new Error("Could not find root element to mount to");const ht=Se.createRoot(fe);ht.render(e.jsx(ke.StrictMode,{children:e.jsx(ut,{})}));
