import{r as h,F as e,G as ke,R as Ce}from"./vendor-base-7ebbgd7M.js";import{r as _e,u as $e}from"./vendor-xlsx-BUW7exb-.js";import{C as Ae,U as pe,a as Me,F as Be,A as Te,S as ge,P as le,b as fe,D as Ie,X as Re,c as oe,R as se,d as Le,e as Ee,T as Oe,Z as ie,f as Q,g as Pe,h as Ue,i as De,I as qe,L as Fe,M as Ke,j as He,k as Je,l as We,m as Ge,G as ze,n as Ve}from"./vendor-icons-D_efKZyk.js";import{R as Ye,L as Ze,C as Xe,X as Qe,Y as et,T as tt,a as ce}from"./vendor-charts-CnHc5vBf.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=o(a);fetch(a.href,l)}})();const be={ä¸€å¹´çº§:["åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘åˆæ­¥","åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘è¿›é˜¶","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],ä¸€å¹´çº§å¼¹çª—:["ç©ºé—´æƒ³è±¡â€”â€”æ­£æ–¹ä½“è®¡æ•°","ç©ºé—´æƒ³è±¡â€”â€”æ•°æ•°çœ‹ä¸è§","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],äºŒå¹´çº§:["åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜è¿›é˜¶","åº”ç”¨é¢˜â€”â€”è¿˜åŸå€’æ¨","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œåˆæ­¥","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œè¿›é˜¶"],ä¸‰å¹´çº§:["åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜è¿›é˜¶","è½¬åŒ–æ€æƒ³â€”å·§æ±‚æœ€çŸ­è·¯çº¿","è®¡ç®—â€”â€”å·§å¡«ç®—ç¬¦","è®¡ç®—â€”â€”å·§è§£æ•´æ•°è®¡ç®—"],å››å¹´çº§:["ç›ˆäºé—®é¢˜","ç”Ÿæ´»ä¸­çš„è®¡æ•°åŸç†","å›¾å½¢ä¸­çš„è®¡æ•°åŸç†","é•¿æ–¹å½¢ä¸­çš„å€æ•°å…³ç³»","æ•°å½¢ç»“åˆ"],äº”å¹´çº§:["åŸºç¡€è¡Œç¨‹é—®é¢˜","ç¯å½¢è·¯çº¿é—®é¢˜","ç«è½¦è¡Œç¨‹é—®é¢˜","å°æ•°ä¹˜é™¤æ³•å·§ç®—","å°æ•°æå–å…¬å› æ•°"],å…­å¹´çº§:["é—´éš”å‘è½¦é—®é¢˜","ç‰¹æ®Šæ³•æ¯”è¾ƒåˆ†æ•°å¤§å°","æ“ä½œä¸è§„å¾‹","ä¸å®šæ–¹ç¨‹","çŸ­é™¤æ¨¡å‹"]},st=s=>{if(!s||isNaN(s))return"0åˆ†é’Ÿ";const r=Math.floor(s/3600),o=s%3600,n=Math.ceil(o/60);return r>0?`${r}å°æ—¶${n>0?` ${n}åˆ†é’Ÿ`:""}`:`${n}åˆ†é’Ÿ`},T=s=>{if(s==null)return 0;if(typeof s=="number")return s*100;if(typeof s=="string"){if(s.includes("%"))return parseFloat(s.replace("%",""));const r=parseFloat(s);return r<=1?r*100:r}return 0},de=s=>{if(typeof s=="number")return s;if(!s)return 0;const r=String(s).trim();if(r.includes("åˆ†")||r.includes("ç§’")){let n=0;const a=r.match(/(\d+)\s*åˆ†/),l=r.match(/(\d+)\s*ç§’/);return a&&(n+=parseInt(a[1],10)*60),l&&(n+=parseInt(l[1],10)),n}const o=parseFloat(r);return isNaN(o)?0:o},ae=s=>{if(!s)return"æœªçŸ¥å¹´çº§";const r={pk:"å¹¼å„¿å›­å°ç­",k:"å¹¼å„¿å›­å¤§ç­",one:"ä¸€å¹´çº§",two:"äºŒå¹´çº§",three:"ä¸‰å¹´çº§",four:"å››å¹´çº§",five:"äº”å¹´çº§",six:"å…­å¹´çº§"},o=s.toLowerCase().trim();if(r[o])return r[o];const n=Object.keys(r).find(a=>o.includes(a));return n?r[n]:s},at=(s,r)=>{const o=new Set;return s.forEach(n=>{if(n.real_name===r){const a=parseInt(String(n.level_sequence),10);isNaN(a)||o.add(a)}}),Array.from(o).sort((n,a)=>n-a)},rt=s=>{if(!s||s.length===0)return{valid:!1,error:"æ–‡ä»¶ä¸ºç©º"};const r=s[0],n=["real_name","level_sequence","unit_sequence","unit_finish_status","answer_right_rate","first_cost_seconds"].filter(a=>!(a in r));return n.length>0?{valid:!1,error:`ç¼ºå°‘å¿…è¦å­—æ®µ: ${n.join(", ")}`}:{valid:!0}},xe=s=>s>=4?{name:"é‡‘ç‰Œå®Œè¯¾ç‹",type:"completion",level:"gold",description:"é‡‘ç‰Œæˆå°±è¾¾æˆï¼å…¨è¯¾ç¨‹é€šå…³ï¼Œä½ å°±æ˜¯å­¦ä¹ ç‹è€…ï¼"}:{name:"å­¦ä¹ ä¹‹æ˜Ÿ",type:"completion",level:"star",description:"å­¦ä¹ ä¹‹æ˜Ÿå·²ç‚¹äº®ï¼è¡¨ç°éå¸¸äº®çœ¼ï¼ŒåŠ æ²¹å‘å‰å†²ï¼"},me=s=>s>=90?{name:"å­¦ä¹ å…¸èŒƒ",type:"accuracy",level:"model",description:"ä½ çš„å­¦ä¹ è´¨é‡æé«˜ï¼Œå±•ç°å…¸èŒƒçº§çš„æŒæ¡åŠ›ã€‚"}:{name:"ç¨³å®šé«˜æ‰‹",type:"accuracy",level:"master",description:"ç¨³å®šä¸”æ‰å®ï¼Œä¿æŒè¿™ä¸ªèŠ‚å¥ï¼"},he=(s,r,o,n)=>{var j,m,c,y;if(!s||s.length===0)return null;const a=s.filter(f=>f.real_name===r);if(a.length===0)return null;const l=[],i=n?n.max:Math.max(...a.map(f=>parseInt(String(f.level_sequence),10))),p=a.filter(f=>parseInt(String(f.level_sequence),10)===i);if(o==="headteacher"){p.forEach(u=>{const S=parseInt(String(u.unit_sequence),10),R=T(u.answer_right_rate),F=T(u.pass_rate),C=s.filter(_=>parseInt(String(_.level_sequence),10)===i&&parseInt(String(_.unit_sequence),10)===S),g=C.filter(_=>T(_.answer_right_rate)>0),d=g.length>0?g.reduce((_,O)=>_+T(O.answer_right_rate),0)/g.length:0,E=C.filter(_=>T(_.pass_rate)>0),H=E.length>0?E.reduce((_,O)=>_+T(O.pass_rate),0)/E.length:0;l.push({unitNumber:S,unitName:S===0?"è¯¾å‰æµ‹":`ç¬¬${S}è®²`,timeSpentSeconds:de(u.first_cost_seconds),status:u.unit_finish_status==="å®Œè¯¾"?"high":"low",statusLabel:u.unit_finish_status==="å®Œè¯¾"?"å·²å®Œæˆ":"å­¦ä¹ ä¸­",accuracy:R,classAccuracy:d,passRate:F,classPassRate:H,wrongCount:parseInt(String(u.first_finish_answer_step_fail_cnt??u.wrong_answer_count??0)),analysis:""})}),l.sort((u,S)=>u.unitNumber-S.unitNumber);const f=l.find(u=>u.unitNumber===0);let v=0,A=0,M=0,x=0;l.forEach(u=>{u.unitNumber!==0&&(f&&u.accuracy>f.accuracy&&v++,u.status==="high"&&A++,f&&u.timeSpentSeconds<f.timeSpentSeconds&&M++,u.accuracy>=90&&x++)});const b=[{name:"å­¦ä¹ è¿›æ­¥å¾½ç« ",type:"accuracy",level:"progress",description:"æ¯ä¸€æ¬¡çªç ´ï¼Œéƒ½æ˜¯å¯¹è‡ªæˆ‘çš„è¶…è¶Šï¼Œä½ æ˜¯æœ€æ£’çš„è¿›æ­¥å°è¾¾äººï¼",stars:Math.min(5,v)},{name:"åšæŒå°è¾¾äºº",type:"completion",level:"growth",description:"æ»´æ°´ç©¿çŸ³ï¼Œä½ çš„æ¯ä¸€ä»½åšæŒéƒ½åœ¨ä¸ºæˆåŠŸçš„æœªæ¥é“ºè·¯ï¼Œç»§ç»­ä¿æŒï¼",stars:Math.min(5,A)},{name:"æ—¶é—´å°é£ä¾ ",type:"accuracy",level:"potential",description:"çµåŠ¨å¦‚é—ªç”µï¼Œä½ çš„é«˜æ•ˆæ€ç»´è®©å­¦ä¹ å˜å¾—å¦‚æ­¤è½»æ¾ï¼Œä¸ºä½ ç‚¹èµï¼",stars:Math.min(5,M)},{name:"æ»¡åˆ†å†²åˆºæ˜Ÿ",type:"accuracy",level:"master",description:"ç„å‡†ç›®æ ‡ï¼Œå…¨åŠ›ä»¥èµ´ï¼Œä½ çš„ä¸“æ³¨è®©æ¯ä¸€ä¸ªå…³å¡éƒ½å˜å¾—ç®€å•ï¼",stars:Math.min(5,x)}],k=l.reduce((u,S)=>u+S.timeSpentSeconds,0);return{studentName:r,grade:ae((j=a[0])==null?void 0:j.package_grade),teacher:((m=a[0])==null?void 0:m.counselor_name)||"è€å¸ˆ",role:o,totalTimeSeconds:k,avgTimePerSession:k/(l.length||1),timeComment:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼",completionBadge:xe(0),accuracyBadge:me(0),htBadges:b,completedUnitsCount:l.filter(u=>u.status==="high").length,units:l,trendAnalysis:nt(l),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}else{const f=new Map;a.forEach(x=>{const b=parseInt(String(x.level_sequence),10);if(n&&(b<n.min||b>n.max))return;f.has(b)||f.set(b,{unitNumber:b,unitName:`ç¬¬${b}å•å…ƒ`,timeSpentSeconds:0,status:"low",statusLabel:"å­¦ä¹ ä¸­",accuracy:0,classAccuracy:0,passRate:0,classPassRate:0,wrongCount:0,analysis:""});const k=f.get(b);k.timeSpentSeconds+=de(x.first_cost_seconds),k.accuracy=(k.accuracy+T(x.answer_right_rate))/2,k.passRate=(k.passRate+T(x.pass_rate))/2,x.unit_finish_status==="å®Œè¯¾"&&(k.status="high")});const v=Array.from(f.values()).sort((x,b)=>x.unitNumber-b.unitNumber);v.forEach(x=>{const b=s.filter(S=>parseInt(String(S.level_sequence),10)===x.unitNumber),k=b.filter(S=>T(S.answer_right_rate)>0);x.classAccuracy=k.length>0?k.reduce((S,R)=>S+T(R.answer_right_rate),0)/k.length:0;const u=b.filter(S=>T(S.pass_rate)>0);x.classPassRate=u.length>0?u.reduce((S,R)=>S+T(R.pass_rate),0)/u.length:0,x.status==="high"?x.accuracy>=x.classAccuracy?x.analysis="æŒæ¡æ‰å®ï¼Œè¶…è¶Šå¹³å‡":x.analysis="æ€åº¦è®¤çœŸï¼Œè¯·å·©å›ºé”™é¢˜":x.analysis=""});const A=v.reduce((x,b)=>x+b.timeSpentSeconds,0),M=v.reduce((x,b)=>x+b.accuracy,0)/(v.length||1);return{studentName:r,grade:ae((c=a[0])==null?void 0:c.package_grade),teacher:((y=a[0])==null?void 0:y.counselor_name)||"è€å¸ˆ",role:o,totalTimeSeconds:A,avgTimePerSession:A/(v.length||1),timeComment:"å­¦ä¹ æ•ˆç‡å¾ˆé«˜ï¼Œè¡¨ç°å‡ºè‰²ã€‚",completionBadge:xe(v.filter(x=>x.status==="high").length),accuracyBadge:me(M),completedUnitsCount:v.filter(x=>x.status==="high").length,units:v,trendAnalysis:lt(v),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}};function nt(s){const r=s.find(i=>i.unitNumber===0),o=s.filter(i=>i.unitNumber>0);if(o.length===0)return{status:"stable",title:"å¼€å¯æŒ‘æˆ˜",content:"å®è´å·²å‡†å¤‡å°±ç»ªï¼ŒæœŸå¾…å¼€å¯ç²¾å½©çš„æ€ç»´é—¯å…³ä¹‹æ—…ï¼"};const n=o[o.length-1];let a=o.length>=2,l=!1;for(let i=1;i<o.length;i++){if(o[i].wrongCount>o[i-1].wrongCount){a=!1;break}o[i].wrongCount<o[i-1].wrongCount&&(l=!0)}if(a&&l)return{status:"rising",title:"æ­¥æ­¥ä¸ºè¥ï¼Œé£é€Ÿè¿›æ­¥",content:"æ­¥æ­¥ä¸ºè¥ï¼Œé”™é¢˜æŒç»­å‡å°‘ï¼Œå­¦ä¹ ä¹ æƒ¯ä¸æ•ˆæœä¿±ä½³ï¼Œè¿›æ­¥é£é€Ÿï¼"};if(r){if(n.wrongCount<r.wrongCount)return{status:"improving",title:"ç¨³æ‰ç¨³æ‰“ï¼Œæˆæ•ˆæ˜¾è‘—",content:"é”™é¢˜æ—¥ç›Šå‡å°‘ï¼Œå¯è§çŸ¥è¯†æŒæ¡è¶Šå‘æ‰å®ç‰¢å›ºï¼"};if(n.wrongCount>r.wrongCount)return{status:"extension",title:"å‹‡æ”€é«˜å³°ï¼Œæ€ç»´æ‹“å±•",content:"æŒ‘æˆ˜å‡çº§ï¼Œæ•¢äºå°è¯•å¤æ‚é¢˜ç›®ï¼Œæ­£æ˜¯æ€ç»´æ·±å…¥æ‹“å±•çš„è¡¨ç°ï¼"}}return{status:"stable",title:"ä¿æŒçŠ¶æ€ï¼Œè“„åŠ¿å¾…å‘",content:"å±•ç°äº†å‡ºè‰²çš„å­¦ä¹ ä¹ æƒ¯ï¼Œé¢å¯¹æŒ‘æˆ˜æ¯«ä¸é€€ç¼©ã€‚ä¿æŒè¿™ä»½ä¸“æ³¨åŠ›ï¼Œä¸‹ä¸€æ¬¡çªç ´å°±åœ¨çœ¼å‰ï¼"}}function lt(s){if(s.length===0)return{status:"stable",title:"ç¨³æ­¥æå‡",content:"ç»§ç»­ä¿æŒè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼"};const r=s[0],o=s[s.length-1],n=s.every(j=>j.accuracy>=j.classAccuracy),a=r.accuracy<r.classAccuracy,l=o.accuracy>=o.classAccuracy,i=o.accuracy>r.accuracy,p=s.reduce((j,m)=>j+(m.accuracy-m.classAccuracy),0)/s.length;return n&&i?{status:"rising",title:"æŒç»­é¢†å…ˆä¸”ä¸Šå‡",content:"è¡¨ç°ä¼˜ç§€ä¸”æŒç»­è¿›æ­¥ï¼å•å…ƒçš„æ­£ç¡®ç‡å‡é«˜äºç­çº§å¹³å‡æ°´å¹³ï¼Œå¹¶å‘ˆç¨³æ­¥ä¸Šå‡è¶‹åŠ¿ï¼Œå±•ç°æ‰å®çš„æŒæ¡èƒ½åŠ›å’Œè‰¯å¥½çš„å­¦ä¹ èŠ‚å¥ã€‚"}:n?{status:"above",title:"æ•´ä½“é¢†å…ˆ",content:"æ•´ä½“è¡¨ç°ç¨³å®šé¢†å…ˆï¼è™½ç„¶å•å…ƒé—´ç•¥æœ‰æ³¢åŠ¨ï¼Œä½†å…¨ç¨‹å‡é«˜äºç­çº§å¹³å‡çº¿ï¼Œè¯´æ˜åŸºç¡€æ‰å®ï¼Œè‹¥èƒ½åŠ å¼ºæ³¢åŠ¨å•å…ƒçš„å·©å›ºï¼Œè¡¨ç°å°†æ›´å‡ºè‰²ã€‚"}:a&&l&&i?{status:"reversal",title:"ååŠ²åè¶³",content:"è¿›æ­¥æ˜¾è‘—ï¼ŒååŠ²åè¶³ï¼ä»å‰æœŸç¨æ˜¾ç”Ÿç–åˆ°åæœŸç¨³æ­¥è¶…è¶Šç­çº§å¹³å‡ï¼Œä½“ç°äº†è‰¯å¥½çš„é€‚åº”èƒ½åŠ›å’Œåæ€æ”¹è¿›çš„å­¦ä¹ æ€åº¦ã€‚"}:Math.abs(p)<5?{status:"stable",title:"ç´§è·Ÿæ­¥ä¼",content:"è¡¨ç°ç¨³å®šï¼Œè·Ÿç´§ç­çº§æ­¥ä¼ã€‚å„å•å…ƒæ­£ç¡®ç‡ä¸ç­çº§å¹³å‡éå¸¸æ¥è¿‘ï¼Œè‹¥èƒ½è¿›ä¸€æ­¥çªç ´è–„å¼±ç¯èŠ‚ï¼Œæœ‰æœ›å®ç°é¢†å…ˆã€‚"}:i?{status:"rising-below",title:"æ­¥å…¥ä¸Šå‡é€šé“",content:"è™½æš‚æœªè¶…è¶Šå¹³å‡ï¼Œä½†å·²æ­¥å…¥ä¸Šå‡é€šé“ï¼æ­£ç¡®ç‡é€å•å…ƒæå‡ï¼Œæ˜¾ç¤ºä½ æ­£åœ¨é€æ­¥æŒæ¡æ–¹æ³•ï¼Œè¯·ä¿æŒå½“å‰å­¦ä¹ èŠ‚å¥ï¼ŒåŠ å¼ºå¤ä¹ ã€‚"}:{status:"stable",title:"ç¨³æ­¥æå‡",content:"ç»§ç»­ä¿æŒè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼ŒæœŸå¾…ä½ åœ¨åç»­å•å…ƒä¸­æœ‰æ›´ç²¾å½©çš„è¡¨ç°ï¼"}}const ot=s=>{const r=new Map;return s.forEach(o=>{r.has(o.real_name)||r.set(o.real_name,{name:o.real_name,grade:ae(o.package_grade),teacher:o.counselor_name,unitCount:0,lastUnit:0});const n=r.get(o.real_name);n.unitCount++,n.lastUnit=Math.max(n.lastUnit,parseInt(String(o.level_sequence),10))}),Array.from(r.values())},it=({onDataLoaded:s,role:r,onRoleChange:o})=>{const[n,a]=h.useState(null),[l,i]=h.useState(!1),p=c=>{a(null);const y=new FileReader;y.onload=f=>{var v;try{const A=(v=f.target)==null?void 0:v.result,M=_e(A,{type:"binary"}),x=M.Sheets[M.SheetNames[0]],b=$e.sheet_to_json(x),k=rt(b);if(!k.valid)return a(k.error||"æ— æ•ˆæ–‡ä»¶");s(b)}catch{a("è§£ææ–‡ä»¶å‡ºé”™")}},y.readAsBinaryString(c)},j=c=>{c.preventDefault(),i(c.type==="dragenter"||c.type==="dragover")},m=c=>{var y;c.preventDefault(),i(!1),(y=c.dataTransfer.files)!=null&&y[0]&&p(c.dataTransfer.files[0])};return e.jsxs("div",{className:"max-w-2xl mx-auto mt-12 space-y-6",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-2",children:[e.jsxs("button",{onClick:()=>o("counselor"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${r==="counselor"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx(Ae,{className:"w-5 h-5"})," è¯¾å¯¼æ¨¡å¼"]}),e.jsxs("button",{onClick:()=>o("headteacher"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${r==="headteacher"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx(pe,{className:"w-5 h-5"})," ç­ä¸»ä»»æ¨¡å¼"]})]}),e.jsx("div",{className:`p-10 bg-white rounded-[2.5rem] shadow-xl border-4 border-dashed transition-all
          ${l?"border-indigo-400 bg-indigo-50":"border-slate-100"}
          ${n?"border-red-200 bg-red-50":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:m,children:e.jsxs("div",{className:"flex flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:`p-6 rounded-full shadow-sm ${n?"bg-red-100":"bg-indigo-100"}`,children:e.jsx(Me,{className:`w-12 h-12 ${n?"text-red-500":"text-indigo-500"}`})}),e.jsx("h2",{className:"text-3xl font-black text-slate-800",children:"ä¸Šä¼ å­¦ä¹ æ•°æ® Excel"}),e.jsx("p",{className:"text-slate-400 font-bold max-w-sm",children:"è¯·ä¸Šä¼ ç­çº§å­¦ä¹ è®°å½•è¡¨æ ¼ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ ¹æ®æ‰€é€‰èº«ä»½ç”Ÿæˆç²¾ç¾æŠ¥å‘Š"}),e.jsxs("label",{className:"cursor-pointer bg-slate-800 hover:bg-slate-900 text-white font-black px-12 py-4 rounded-3xl transition-all shadow-xl hover:-translate-y-1 flex items-center gap-2",children:[e.jsx(Be,{className:"w-6 h-6"})," é€‰æ‹©æ–‡ä»¶",e.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:c=>{var y;return((y=c.target.files)==null?void 0:y[0])&&p(c.target.files[0])}})]})]})})]})},ct=({data:s,color:r="#f97316",isZoomed:o=!1,metric:n="accuracy"})=>{const a=n,l=n==="accuracy"?"classAccuracy":"classPassRate",i=n==="accuracy"?"ä½œç­”æ­£ç¡®ç‡":"è¿‡å…³ç‡",p=s.map(m=>({name:m.unitNumber,displayOrder:String(m.unitNumber),fullName:m.unitName,value:m[a],classAverage:m[l]})),j=()=>{if(!o||p.length===0)return[0,100];const m=p.flatMap(f=>[f.value,f.classAverage]).filter(f=>typeof f=="number");if(m.length===0)return[0,100];const c=Math.min(...m);return[Math.max(0,Math.floor(c-5)),100]};return e.jsx("div",{className:"w-full h-full flex flex-col font-sans",children:e.jsx("div",{className:"flex-grow min-h-0",children:e.jsx(Ye,{width:"100%",height:"100%",children:e.jsxs(Ze,{data:p,margin:{top:20,right:30,left:0,bottom:20},children:[e.jsx(Xe,{strokeDasharray:"3 3",vertical:!1,stroke:"#e7e5e4"}),e.jsx(Qe,{dataKey:"displayOrder",tick:{fontSize:12,fill:"#78716c",fontWeight:800},axisLine:!1,tickLine:!1,padding:{left:20,right:20}}),e.jsx(et,{domain:j(),tick:{fontSize:12,fill:"#78716c",fontWeight:700},axisLine:!1,tickLine:!1,width:35}),e.jsx(tt,{formatter:(m,c)=>[`${m.toFixed(1)}%`,c==="value"?`æˆ‘çš„${i}`:`ç­çº§å¹³å‡${i}`],contentStyle:{borderRadius:"16px",border:`2px solid ${r}`,backgroundColor:"#fff",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",fontFamily:"Nunito, sans-serif",color:"#44403c",fontWeight:"bold"},labelFormatter:m=>`ç¬¬ ${m} å•å…ƒ`,cursor:{stroke:r,strokeWidth:2,strokeDasharray:"4 4"}}),e.jsx(ce,{type:"monotone",dataKey:"classAverage",name:"classAverage",stroke:"#cbd5e1",strokeWidth:4,strokeDasharray:"8 8",dot:{r:0},activeDot:!1}),e.jsx(ce,{connectNulls:!0,type:"monotone",dataKey:"value",name:"value",stroke:r,strokeWidth:5,dot:{r:6,fill:"#fff",stroke:r,strokeWidth:4},activeDot:{r:9,fill:r,stroke:"#fff",strokeWidth:3}})]})})})})},te={default:{id:"default",label:"ç»å…¸æš–é˜³",icon:e.jsx(Q,{className:"w-4 h-4"}),containerClass:"rounded-[3.5rem] border-[6px] shadow-2xl",cardClass:"rounded-[2rem] border-2 shadow-sm",headerClass:"border-b-4",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/confetti.png",colors:{bgMain:"bg-white",textMain:"text-stone-700",textMuted:"text-stone-400",headerBg:"bg-[#FFF8E1]",headerText:"text-amber-800",primary:"bg-amber-400 hover:bg-amber-500 text-white shadow-[0_4px_0_#d97706]",secondary:"bg-white border-2 border-stone-200 text-stone-400 hover:border-red-200 hover:text-red-500",border:"border-amber-100",profileBg:"bg-sky-50",badgesBg:"bg-[#fffbf0]",statsBg:"bg-stone-50",chartBg:"bg-[#fffaf5]",tableHeader:"bg-stone-50 text-stone-500",teacherSection:"bg-sky-50 border-amber-100",rankingHeaderBg:"bg-blue-50 border-blue-100",rankingHighlightRow:"bg-amber-50",rankingBannerBg:"bg-[#ff8a80]",rankingBannerText:"text-white"}},boy:{id:"boy",label:"æ˜Ÿé™…æ¢ç´¢",icon:e.jsx(se,{className:"w-4 h-4"}),containerClass:"rounded-[3rem] border-[5px] shadow-[0_10px_50px_rgba(59,130,246,0.15)]",cardClass:"rounded-[2.5rem] border-2 border-b-4",headerClass:"border-b-4 border-blue-900/10",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/cubes.png",colors:{bgMain:"bg-slate-50",textMain:"text-slate-800",textMuted:"text-slate-400",headerBg:"bg-blue-100",headerText:"text-blue-900",primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-[0_4px_0_#1e3a8a]",secondary:"bg-white border-2 border-slate-300 text-slate-500 hover:border-blue-500 hover:text-blue-600",border:"border-blue-200",profileBg:"bg-white",badgesBg:"bg-gradient-to-br from-blue-50 to-slate-100",statsBg:"bg-slate-100",chartBg:"bg-white",tableHeader:"bg-slate-200 text-slate-600 uppercase tracking-wider",teacherSection:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white border-none",rankingHeaderBg:"bg-blue-100 border-blue-200",rankingHighlightRow:"bg-blue-50",rankingBannerBg:"bg-blue-500",rankingBannerText:"text-white"}},girl:{id:"girl",label:"æ¢¦å¹»äº‘æœµ",icon:e.jsx(Ge,{className:"w-4 h-4"}),containerClass:"rounded-[4rem] border-[8px] border-double shadow-2xl ring-8 ring-rose-50",cardClass:"rounded-[2.5rem] border-2 border-dashed shadow-[4px_4px_0px_rgba(253,164,175,0.3)]",headerClass:"border-b-[3px] border-dashed",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/hearts.png",colors:{bgMain:"bg-[#fffcfd]",textMain:"text-stone-600",textMuted:"text-rose-200",headerBg:"bg-rose-50",headerText:"text-stone-700",primary:"bg-rose-200 hover:bg-rose-300 text-stone-700 shadow-[0_4px_0_#fda4af]",secondary:"bg-white/80 border-2 border-rose-100 text-rose-300 hover:bg-white",border:"border-rose-100",profileBg:"bg-white/60 backdrop-blur-sm",badgesBg:"bg-gradient-to-b from-rose-50/20 to-white/50",statsBg:"bg-rose-50/40",chartBg:"bg-white/60",tableHeader:"bg-rose-50 text-rose-300",teacherSection:"bg-stone-50 border-rose-100",rankingHeaderBg:"bg-stone-50 border-stone-100",rankingHighlightRow:"bg-rose-50",rankingBannerBg:"bg-stone-400",rankingBannerText:"text-white"}}},dt=(s,r,o)=>{const n=new Map;s.forEach(l=>{const i=o==="headteacher",p=parseInt(String(l.level_sequence),10),j=parseInt(String(l.unit_sequence),10);if(i){if(p!==r.max)return}else if(isNaN(p)||p<r.min||p>r.max)return;n.has(l.real_name)||n.set(l.real_name,{accuracies:{},totalScore:0,avgAccuracy:0,count:0,id:l.user_id});const m=n.get(l.real_name),c=T(l.answer_right_rate);m.accuracies[j]=c});const a=Array.from(n.entries()).map(([l,i])=>{let p=0,j=0,m=0;return o==="headteacher"?[0,1,2,3,4,5].forEach(c=>{i.accuracies[c]!==void 0&&(p+=i.accuracies[c])}):Object.values(i.accuracies).forEach(c=>{j+=c,m++}),{name:l,userId:i.id,accuracies:i.accuracies,totalScore:Math.round(p),avgAccuracy:m>0?j/m:0,rank:0}});return o==="headteacher"?a.sort((l,i)=>i.totalScore-l.totalScore):a.sort((l,i)=>i.avgAccuracy-l.avgAccuracy),a.forEach((l,i)=>l.rank=i+1),{rankings:a,total:a.length}},ue=[0,1,2,3,4,5],xt=({data:s,rawData:r,onBack:o,availableUnits:n,currentRange:a,onRangeChange:l,currentTheme:i,onThemeChange:p,selectedCurriculumKey:j,setSelectedCurriculumKey:m,onSwitchStudentById:c,isChartZoomed:y,onToggleZoom:f,trendMetric:v,onToggleMetric:A,customUnitNames:M,onUpdateCustomUnitNames:x,customAssociations:b,onUpdateCustomAssociations:k,customKPCounts:u,onUpdateCustomKPCounts:S,customErrorCounts:R,onUpdateCustomErrorCounts:F})=>{var re;const C=te[i],g=C.colors,d=s.role==="headteacher",[E,H]=h.useState(""),[_,O]=h.useState(!1),[Y,Z]=h.useState(M.join(`
`)),[X,ee]=h.useState(b.join(`
`)),[J,N]=h.useState(u.join(`
`)),[$,P]=h.useState(R.join(`
`)),G=be[j]||[],{rankings:U,total:z}=h.useMemo(()=>dt(r,a,s.role),[r,a,s.role]),L=U.find(t=>t.name===s.studentName),V=h.useMemo(()=>{const t=U.findIndex(w=>w.name===s.studentName);return t===-1?[]:U.slice(Math.max(0,t-5),Math.min(U.length,t+6))},[U,s.studentName]),je=()=>{x(Y.split(`
`).map(t=>t.trim())),d||(k(X.split(`
`).map(t=>t.trim())),S(J.split(`
`).map(t=>t.trim())),F($.split(`
`).map(t=>t.trim()))),O(!1)},we=t=>{if(t===0)return"è¯¾å‰æµ‹";const w=M[t-1];return w&&w.trim()?w:d&&t>=1&&t<=5?G[t-1]||`ç¬¬${t}è®²`:d?`ç¬¬${t}è®²`:`ç¬¬${t}å•å…ƒ`},ye=t=>d||t===0?"":b[t-1]||"",W=h.useMemo(()=>s.units.map(t=>{const w=we(t.unitNumber),B=t.status==="low"?`ã€${w}ã€‘ç­‰ä½ æŒ‘æˆ˜`:t.analysis;return{...t,unitName:w,association:ye(t.unitNumber),analysis:B}}),[s.units,d,G,M,b]),D=h.useMemo(()=>{if(d||W.length!==4)return null;let t=0,w=0;const B=[],I=[];return W.forEach(K=>{const ne=K.unitNumber-1;t+=parseInt(u[ne]||"0"),w+=parseInt(R[ne]||"0"),K.accuracy>K.classAccuracy?B.push(K.unitName):I.push(K.unitName)}),{totalKPs:t,totalErrors:w,totalMinutes:Math.ceil(s.totalTimeSeconds/60),highPerformersJoined:B.join("ã€"),lowPerformersJoined:I.join("ã€")}},[d,W,u,R,s.totalTimeSeconds]),ve=t=>{if(!t)return null;const w=t.includes("é«˜é¢‘"),B=t.includes("é‡ç‚¹"),I=t.includes("æ‹“å±•")||t.includes("æ€ç»´");return w?e.jsxs("span",{className:"px-2 py-1 rounded bg-rose-50 text-rose-500 border border-rose-200 text-[10px] font-black shadow-[2px_2px_0_rgba(244,63,94,0.1)]",children:["ğŸ”¥ ",t]}):B?e.jsx("span",{className:"px-2 py-1 rounded bg-indigo-50 text-indigo-500 border border-indigo-100 text-[10px] font-black",children:t}):I?e.jsxs("span",{className:"px-2 py-1 rounded bg-emerald-50 text-emerald-500 border border-emerald-100 text-[10px] font-black",children:["ğŸ’¡ ",t]}):e.jsx("span",{className:"px-2 py-1 rounded bg-slate-50 text-slate-400 text-[10px] font-bold",children:t})},Se=()=>{if(!L)return"ç»§ç»­åŠªåŠ›ï¼Œäº‰å–æ›´å¥½çš„æˆç»©ï¼";const{rank:t}=L,w=t/(z||1);return t===1?"ç‹¬å é³Œå¤´ï¼ä½ æ˜¯å…¨ç­æœ€é—ªäº®çš„å­¦ä¹ æ˜æ˜Ÿï¼Œå±•ç°äº†éå‡¡çš„æŒæ¡åŠ›ï¼":t<=3?"ååˆ—å‰èŒ…ï¼ä¼˜ç§€çš„å­¦ä¹ ä¹ æƒ¯æ˜¯ä½ æˆåŠŸçš„åŸºçŸ³ï¼Œä¿æŒè¿™ä»½å†²åŠ²ï¼":w<=.2?"è¡¨ç°ä¼˜å¼‚ï¼å·²è¿›å…¥ç­çº§ç¬¬ä¸€æ¢¯é˜Ÿï¼Œç»§ç»­ä¿æŒç¨³å¥çš„æ­¥ä¼ï¼Œå†²åˆºå·…å³°ï¼":w<=.5?"è¿›æ­¥æ˜¾è‘—ï¼ä½ æ­£èµ°åœ¨ç¨³æ­¥æå‡çš„é˜¶æ¢¯ä¸Šï¼Œç¦»å°–å­ç”Ÿè¡Œåˆ—ä»…ä¸€æ­¥ä¹‹é¥ï¼":"æ½œåŠ›æ— é™ï¼ä¿æŒä¸“æ³¨ä¸è€å¿ƒï¼Œæ¯ä¸€ä»½æ±—æ°´éƒ½ä¼šåœ¨æœªæ¥çš„è€ƒè¯•ä¸­å¼€å‡ºç¿çƒ‚ä¹‹èŠ±ï¼"};return e.jsxs("div",{className:`max-w-6xl mx-auto my-6 font-sans ${g.textMain}`,children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-center px-4 gap-4 print:hidden",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{onClick:o,className:"bg-white px-6 py-2.5 rounded-full border-2 border-slate-100 shadow-sm font-black flex items-center gap-2 transition-all hover:scale-105 active:scale-95",children:[e.jsx(Te,{className:"w-5 h-5"}),"åˆ—è¡¨"]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),c(E),H("")},className:"relative group",children:[e.jsx(ge,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300 group-focus-within:text-indigo-400 transition-colors"}),e.jsx("input",{type:"text",value:E,onChange:t=>H(t.target.value),placeholder:"IDåˆ‡æ¢",className:"bg-white pl-10 pr-4 py-2.5 rounded-full border-2 border-slate-100 shadow-sm outline-none focus:border-indigo-100 font-bold text-sm w-32"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-center",children:[e.jsxs("button",{onClick:()=>O(!_),className:`bg-white px-4 py-2 rounded-full border-2 shadow-sm font-black text-xs flex items-center gap-2 transition-all ${_?"border-indigo-400 text-indigo-600":"border-slate-100 text-slate-400 hover:border-indigo-100"}`,children:[e.jsx(le,{className:"w-4 h-4"})," è®¾ç½®è¯¾ç¨‹ä¿¡æ¯"]}),e.jsx("div",{className:"bg-white p-1 rounded-full border-2 border-slate-100 shadow-sm flex",children:Object.keys(te).map(t=>e.jsx("button",{onClick:()=>p(t),className:`px-4 py-1.5 rounded-full text-xs font-black transition-all ${i===t?"bg-slate-800 text-white shadow-md":"text-slate-400"}`,children:te[t].label},t))}),!d&&e.jsxs("div",{className:"bg-white px-4 py-2 rounded-full border-2 border-slate-100 shadow-sm flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-slate-300"}),e.jsx("select",{value:a.min,onChange:t=>l(parseInt(t.target.value),a.max),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:n.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))}),e.jsx("span",{className:"text-slate-200",children:"~"}),e.jsx("select",{value:a.max,onChange:t=>l(a.min,parseInt(t.target.value)),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:n.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))})]}),e.jsxs("button",{onClick:()=>window.print(),className:`px-8 py-2.5 rounded-full font-black flex items-center gap-2 transition-all active:translate-y-1 ${g.primary}`,children:[e.jsx(Ie,{className:"w-5 h-5"}),"æ‰“å°/å¯¼å‡º"]})]})]}),_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm p-4 print:hidden",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-black text-indigo-900 flex items-center gap-3",children:[e.jsx(le,{className:"w-8 h-8"})," æ‰‹åŠ¨æ‰¹é‡è®¾ç½®è¯¾ç¨‹ä¿¡æ¯"]}),e.jsx("p",{className:"text-xs font-bold text-slate-400 mt-1",children:"æ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªå•å…ƒé¡ºåºã€‚è¯·ç¡®ä¿å„åˆ—è¡Œæ•°å¯¹é½ã€‚"})]}),e.jsx("button",{onClick:()=>O(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(Re,{className:"w-8 h-8 text-slate-300"})})]}),e.jsxs("div",{className:`flex-grow overflow-y-auto p-8 grid ${d?"grid-cols-1":"grid-cols-4"} gap-6`,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"å•å…ƒåç§°"}),e.jsx("textarea",{value:Y,onChange:t=>Z(t.target.value),placeholder:"ç¬¬ä¸€è¡Œå¯¹åº”ç¬¬1å•å…ƒ/è®²...",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),!d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"å­¦ä¹ å…³è”"}),e.jsx("textarea",{value:X,onChange:t=>ee(t.target.value),placeholder:"é«˜é¢‘è€ƒç‚¹/æ‹“å±•å†…å®¹...",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"çŸ¥è¯†ç‚¹æ•°é‡"}),e.jsx("textarea",{value:J,onChange:t=>N(t.target.value),placeholder:"12",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 ml-2",children:"æ˜“é”™ç‚¹æ•°é‡"}),e.jsx("textarea",{value:$,onChange:t=>P(t.target.value),placeholder:"3",className:"w-full h-64 bg-slate-50 border-2 border-slate-100 rounded-2xl p-3 text-xs font-bold focus:border-indigo-300 outline-none resize-none"})]})]})]}),e.jsxs("div",{className:"p-8 border-t bg-slate-50/50 flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>O(!1),className:"px-8 py-3 rounded-full font-black text-slate-400 hover:text-slate-600 transition-colors",children:"æ”¾å¼ƒä¿®æ”¹"}),e.jsxs("button",{onClick:je,className:"px-12 py-3 bg-indigo-600 text-white rounded-full font-black shadow-lg hover:bg-indigo-700 transition-all flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"ç¡®è®¤å¹¶åŒæ­¥"]})]})]})}),e.jsxs("div",{className:`${g.bgMain} ${C.containerClass} ${g.border} overflow-hidden relative print:shadow-none print:border-none print:rounded-none transition-all duration-700 mx-auto print:w-full`,children:[e.jsx("div",{className:`${g.headerBg} py-12 text-center relative border-b-4 ${g.border}`,children:e.jsxs("h1",{className:`text-4xl font-black ${g.headerText} tracking-tight drop-shadow-sm flex items-center justify-center gap-3`,children:[i==="boy"?e.jsx(se,{className:"w-10 h-10 animate-pulse"}):e.jsx(Le,{className:"w-10 h-10 text-yellow-300 fill-current"}),s.studentName," ",d?"ä¸“å±å­¦ä¹ æŠ¥å‘Š":`${a.min}-${a.max}å•å…ƒ å­¦ä¹ æŠ¥å‘Š`]})}),e.jsxs("div",{className:`flex flex-col md:flex-row border-b-4 ${g.border}`,children:[e.jsxs("div",{className:`w-full md:w-1/3 ${g.profileBg} p-10 border-b-4 md:border-b-0 md:border-r-4 ${g.border} flex flex-col justify-center`,children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:`w-16 h-16 rounded-3xl flex items-center justify-center border-4 shadow-sm ${i==="boy"?"bg-blue-600 text-white border-blue-200":"bg-rose-100 text-stone-500 border-white"}`,children:e.jsx(Ee,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-2xl",children:"å­¦å‘˜æ¡£æ¡ˆ"}),e.jsx("p",{className:"text-xs opacity-40 font-bold uppercase tracking-widest",children:"Profile Card"})]})]}),e.jsxs("div",{className:`${C.cardClass} bg-white p-8 space-y-6`,children:[e.jsxs("div",{className:"flex justify-between border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40",children:"å§“å"}),e.jsx("span",{className:"font-black text-xl",children:s.studentName})]}),e.jsxs("div",{className:"flex justify-between border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40",children:"å¹´çº§"}),e.jsx("span",{className:"px-4 py-1 rounded-full bg-slate-100 font-bold text-sm",children:s.grade})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-bold opacity-40",children:"è€å¸ˆ"}),e.jsx("span",{className:"font-bold",children:s.teacher})]})]})]}),e.jsxs("div",{className:`w-full md:w-2/3 ${g.badgesBg} p-10`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(Oe,{className:"w-8 h-8 text-amber-400"}),e.jsx("h3",{className:"text-2xl font-black",children:d?"å­¦ä¹ æˆé•¿å‹‹ç« ":"è£èª‰æˆå°±"})]}),d?e.jsx("div",{className:"grid grid-cols-2 gap-6",children:(re=s.htBadges)==null?void 0:re.map(t=>e.jsxs("div",{className:`${C.cardClass} bg-white/80 backdrop-blur-sm p-4 flex flex-col items-center justify-center shadow-sm`,children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center mb-2 shadow-sm ${i==="boy"?"bg-blue-600 text-white":"bg-rose-50 text-rose-300"}`,children:t.level==="progress"?e.jsx(ie,{className:"w-6 h-6"}):t.level==="potential"?e.jsx(se,{className:"w-6 h-6"}):e.jsx(Q,{className:"w-6 h-6"})}),e.jsx("h4",{className:"font-black text-sm mb-1",children:t.name}),e.jsx("div",{className:"flex gap-0.5 mb-2",children:[...Array(5)].map((w,B)=>e.jsx(Q,{className:`w-3.5 h-3.5 ${B<(t.stars||0)?"text-yellow-400 fill-yellow-400":"text-slate-200 fill-slate-100"}`},B))}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400/80 text-center leading-tight italic",children:["â€œ",t.description,"â€"]})]},t.name))}):e.jsxs("div",{className:"flex gap-10",children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform rotate-3 mb-4 ${i==="boy"?"bg-amber-400 border-4 border-white":"bg-rose-50 border-rose-100 border-2"}`,children:e.jsx(Q,{className:`w-12 h-12 ${i==="boy"?"text-white":"text-rose-300"}`})}),e.jsx("p",{className:"font-black text-lg mb-2",children:s.completionBadge.name}),e.jsx("div",{className:`${C.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.completionBadge.description})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform -rotate-3 mb-4 ${i==="boy"?"bg-blue-600 border-4 border-white":"bg-amber-50 border-amber-100 border-2"}`,children:e.jsx(Pe,{className:"w-12 h-12 text-white"})}),e.jsx("p",{className:"font-black text-lg mb-2",children:s.accuracyBadge.name}),e.jsx("div",{className:`${C.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.accuracyBadge.description})]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:`w-full ${d?"lg:w-[45%]":"lg:w-[55%]"} border-b-4 lg:border-b-0 lg:border-r-4 ${g.border} bg-white p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3 whitespace-nowrap",children:[e.jsx(Ue,{className:"w-8 h-8 text-indigo-500"}),d?`${s.studentName}åŒå­¦ å­¦ä¹ è®°å½•`:"å­¦ä¹ é—¯å…³è®°å½•"]}),e.jsx("div",{className:"mt-2 px-6 py-2 bg-indigo-50 rounded-full text-indigo-600 font-black text-xs w-fit",children:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼"})]}),e.jsx("div",{className:`${C.cardClass} border-2 overflow-hidden flex-grow`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:g.tableHeader,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left",children:"å•å…ƒå†…å®¹"}),!d&&e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ å…³è”"}),e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ æ—¶é•¿"}),!d&&e.jsx("th",{className:"px-4 py-4 text-center",children:"å­¦ä¹ åˆ†æ"}),d&&e.jsx("th",{className:"px-4 py-4 text-right",children:"é”™è¯¯ç»Ÿè®¡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:W.map((t,w)=>{const B=Math.max(...W.map(K=>K.wrongCount),1),I=t.wrongCount/B*80;return e.jsxs("tr",{className:`transition-colors ${w%2===0?"bg-white":"bg-slate-50/50"} hover:bg-slate-100`,children:[e.jsx("td",{className:"px-4 py-5 font-black whitespace-nowrap text-xs",children:t.unitName}),!d&&e.jsx("td",{className:"px-4 py-5 text-center",children:ve(t.association)}),e.jsx("td",{className:"px-4 py-5 text-center font-bold opacity-50 text-xs",children:st(t.timeSpentSeconds)}),!d&&e.jsx("td",{className:`px-4 py-5 text-center font-black text-[11px] whitespace-nowrap ${t.status==="low"?"text-slate-300":"text-indigo-500"}`,children:t.analysis}),d&&e.jsx("td",{className:"px-4 py-5 text-right min-w-[120px]",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("div",{className:"h-2 bg-rose-100 rounded-full overflow-hidden w-20 flex-shrink-0",children:e.jsx("div",{className:"h-full bg-rose-400 rounded-full",style:{width:`${I}%`}})}),e.jsx("span",{className:"font-black text-rose-400 text-xs w-6 text-right",children:t.wrongCount})]})})]},t.unitNumber)})})]})})}),!d&&D&&e.jsxs("div",{className:"mt-8 space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:`${C.cardClass} bg-indigo-600 text-white p-8 relative overflow-hidden shadow-xl`,children:[e.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"}),e.jsxs("h4",{className:"text-xl font-black flex items-center gap-3 mb-6",children:[e.jsx(De,{className:"w-6 h-6"})," ğŸ“ˆ å­¦ä¹ é‡Œç¨‹ç¢‘"]}),e.jsxs("p",{className:"text-sm font-bold leading-loose opacity-90",children:["æœ¬æœˆä½ ç´¯è®¡å­¦ä¹  ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:D.totalMinutes})," åˆ†é’Ÿï¼Œæ¯ä¸€åˆ†é’Ÿï¼Œéƒ½åœ¨æŠŠè–„å¼±å˜æˆå¼ºé¡¹ã€‚å®Œæˆã€",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:D.totalKPs}),"ä¸ªçŸ¥è¯†ç‚¹ã€‘ç›¸å½“äºæ”»å…‹äº† ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1",children:D.totalErrors}),"ä¸ªé«˜é¢‘æ˜“é”™ç‚¹ï¼Œæ‰«æ¸…å¹´çº§çŸ¥è¯†ç›²åŒºã€‚"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`${C.cardClass} bg-emerald-50 border-emerald-100 p-6`,children:[e.jsxs("h4",{className:"text-emerald-700 font-black flex items-center gap-2 mb-4 text-sm",children:[e.jsx(oe,{className:"w-5 h-5"})," âœ¨ å•å…ƒè¡¨ç°äº®ç‚¹"]}),e.jsx("div",{className:"space-y-3",children:D.highPerformersJoined?e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"w-2 h-2 mt-1.5 rounded-full bg-emerald-400"}),e.jsxs("p",{className:"text-[11px] font-bold text-emerald-800 leading-relaxed",children:[e.jsxs("span",{className:"font-black text-emerald-600",children:["ã€",D.highPerformersJoined,"ã€‘"]})," è¡¨ç°çªå‡ºï¼Œæ­£ç¡®ç‡æŒç»­é¢†å…ˆï¼Œæ€è·¯æ¸…æ™°ã€‚"]})]}):e.jsx("p",{className:"text-[11px] font-bold text-emerald-400 italic",children:"ç»§ç»­æŒ‘æˆ˜ï¼Œä¸‹æœˆäº‰å–ä¸Šæ¦œï¼"})})]}),e.jsxs("div",{className:`${C.cardClass} bg-rose-50 border-rose-100 p-6`,children:[e.jsxs("h4",{className:"text-rose-700 font-black flex items-center gap-2 mb-4 text-sm",children:[e.jsx(qe,{className:"w-5 h-5"})," ğŸ’¡ å¾…æå‡å•å…ƒ"]}),e.jsx("div",{className:"space-y-3",children:D.lowPerformersJoined?e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"w-2 h-2 mt-1.5 rounded-full bg-rose-400"}),e.jsxs("p",{className:"text-[11px] font-bold text-rose-800 leading-relaxed",children:[e.jsxs("span",{className:"font-black text-rose-600",children:["ã€",D.lowPerformersJoined,"ã€‘"]})," æ­£ç¡®ç‡æš‚æ—¶è½åï¼Œå»ºè®®åŠ å¼ºå¤ä¹ ä¸å·©å›ºã€‚"]})]}):e.jsx("p",{className:"text-[11px] font-bold text-emerald-600 italic",children:"å…¨çº¿é£˜ç»¿ï¼è¡¨ç°æ— å¯æŒ‘å‰”ï¼"})})]})]})]})]}),e.jsxs("div",{className:`w-full ${d?"lg:w-[55%]":"lg:w-[45%]"} ${g.chartBg} p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3",children:[e.jsx(Fe,{className:"w-8 h-8 text-amber-500"}),d?`${s.studentName}åŒå­¦ è¯¾ç¨‹è¶‹åŠ¿`:"è¶‹åŠ¿åˆ†æ"]}),e.jsxs("div",{className:"flex items-center gap-2 print:hidden",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>A("accuracy"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="accuracy"?"bg-white shadow-sm text-indigo-600":"text-slate-400"}`,children:"æ­£ç¡®ç‡"}),e.jsx("button",{onClick:()=>A("passRate"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="passRate"?"bg-white shadow-sm text-indigo-600":"text-slate-400"}`,children:"è¿‡å…³ç‡"})]}),d&&e.jsx("button",{onClick:f,className:`p-2 rounded-xl border-2 transition-all ${y?"bg-amber-100 border-amber-300 text-amber-700":"bg-white text-slate-400"}`,children:y?e.jsx(Ke,{className:"w-4 h-4"}):e.jsx(He,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:`${C.cardClass} bg-white p-6 h-[400px] mb-8 relative shadow-md border-indigo-50 border-4`,children:[e.jsx(ct,{data:W,color:d?"#818cf8":"#f97316",isZoomed:d&&y,metric:v}),e.jsxs("div",{className:"absolute top-4 right-6 flex items-center gap-4 text-[9px] font-black uppercase text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-3 h-1 ${d?"bg-[#818cf8]":"bg-[#f97316]"}`}),"æœ¬äºº"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-1 bg-slate-200 border-t border-dashed border-slate-400"}),"å‡å€¼"]})]})]}),e.jsxs("div",{className:`${C.cardClass} bg-white p-6 shadow-sm border-2 ${g.border}`,children:[e.jsxs("h4",{className:`text-lg font-black mb-4 flex items-center gap-2 ${g.headerText}`,children:[e.jsx(ie,{className:"w-5 h-5 text-yellow-400 fill-current"}),s.trendAnalysis.title]}),e.jsxs("p",{className:"font-bold text-sm leading-relaxed opacity-80 italic",children:["â€œ",s.trendAnalysis.content,"â€"]})]})]})]}),e.jsx("div",{className:"bg-white p-10",children:e.jsxs("div",{className:`${C.cardClass} border-2 ${g.border} overflow-hidden shadow-sm`,children:[e.jsxs("div",{className:`${g.rankingHeaderBg} p-6 border-b flex justify-between items-center`,children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3",children:[e.jsx(Je,{className:"w-8 h-8 text-stone-400"}),"æ­£ç¡®ç‡æ’å"]}),e.jsxs("span",{className:"font-bold text-xs opacity-40",children:["å…±æœ‰ ",z," åå­¦å‘˜å‚ä¸ç»Ÿè®¡"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50/80 text-slate-400 font-bold text-[10px] uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left w-20",children:"åæ¬¡"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"å§“å"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"å­¦å· (UID)"}),d&&ue.map(t=>e.jsx("th",{className:`px-2 py-4 text-center whitespace-nowrap ${t===0?"bg-amber-50 text-amber-600 border-r-2 border-amber-100":""}`,children:t===0?"è¯¾å‰æµ‹":`L${t}`},t)),e.jsx("th",{className:"px-6 py-4 text-right",children:d?"ç»¼åˆå¾—åˆ†":"å¹³å‡æ­£ç¡®ç‡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:V.map(t=>{const w=t.name===s.studentName,B=w?t.name:(t.name.charAt(0)+"x".repeat(Math.min(t.name.length-1,1))).slice(0,4);return e.jsxs("tr",{className:`${w?g.rankingHighlightRow:"hover:bg-slate-50/50"} transition-all`,children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("span",{className:`w-9 h-9 rounded-2xl flex items-center justify-center font-black ${t.rank<=3?"bg-amber-100 text-amber-600":"bg-slate-100 text-slate-400"} ${w?"ring-4 ring-amber-400/20":""}`,children:t.rank})}),e.jsxs("td",{className:`px-6 py-5 font-black text-base ${w?"text-amber-600":"opacity-70"}`,children:[B,w&&e.jsx("span",{className:"ml-2 text-[10px] bg-amber-400 text-white px-2 py-0.5 rounded-full font-sans uppercase",children:"ME"})]}),e.jsx("td",{className:"px-6 py-5 font-black text-sm font-mono opacity-50",children:t.userId}),d&&ue.map(I=>e.jsx("td",{className:`px-2 py-5 text-center font-bold text-[10px] ${I===0?"bg-amber-50/30 border-r-2 border-amber-100/50":""} ${t.accuracies[I]!==void 0?"text-slate-600":"text-slate-200"}`,children:t.accuracies[I]!==void 0?`${t.accuracies[I].toFixed(0)}%`:"-"},I)),e.jsx("td",{className:"px-6 py-5 text-right font-black text-lg whitespace-nowrap",children:d?t.totalScore:`${t.avgAccuracy.toFixed(1)}%`})]},t.userId)})})]})}),e.jsx("div",{className:`${g.rankingBannerBg} ${g.rankingBannerText} p-8 text-center font-black text-sm italic leading-relaxed`,children:Se()})]})}),e.jsx("div",{className:`${g.teacherSection} p-12 text-center relative overflow-hidden`,children:e.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-6 opacity-40"}),e.jsx("p",{className:"text-2xl font-black italic mb-4 opacity-90 leading-snug",children:"â€œ å­¦ä¹ ä¸ä»…æ˜¯åˆ†æ•°çš„ç´¯ç§¯ï¼Œæ›´æ˜¯æ€ç»´çš„ç ´å£³è€Œå‡ºã€‚äº²çˆ±çš„å®¶é•¿ï¼Œå®è´æ­£åœ¨ç”¨æ¯ä¸€ä¸ªç™¾åˆ†ç‚¹çš„è¿›æ­¥ï¼Œä¹¦å†™å±äºè‡ªå·±çš„æœªæ¥ï¼è®©æˆ‘ä»¬å…±åŒå‘µæŠ¤è¿™ä»½æˆé•¿ã€‚ â€"}),e.jsxs("p",{className:"font-bold opacity-60",children:["â€” æ‚¨çš„è¾…å¯¼è€å¸ˆ ",s.teacher]})]})})]})]})},mt=({data:s,onSelectStudent:r,onReupload:o})=>{const[n,a]=h.useState(""),[l,i]=h.useState("all"),p=h.useMemo(()=>ot(s),[s]),j=h.useMemo(()=>{const c=new Set(p.map(y=>y.grade));return Array.from(c).filter(Boolean)},[p]),m=h.useMemo(()=>p.filter(c=>{const y=c.name.toLowerCase().includes(n.toLowerCase())||c.teacher.toLowerCase().includes(n.toLowerCase()),f=l==="all"||c.grade===l;return y&&f}),[p,n,l]);return e.jsxs("div",{className:"max-w-5xl mx-auto my-8 space-y-6 font-sans",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-indigo-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-xl text-indigo-600",children:e.jsx(pe,{className:"w-6 h-6"})}),"å­¦ç”Ÿæ•°æ®åˆ—è¡¨"]}),e.jsxs("p",{className:"text-indigo-400 font-medium mt-2 ml-1",children:["å…±å¯¼å…¥ ",p.length," åå­¦ç”Ÿï¼Œ",s.length," æ¡å­¦ä¹ è®°å½•"]})]}),e.jsx("button",{onClick:o,className:"text-sm font-bold text-gray-400 hover:text-red-500 underline transition-colors",children:"é‡æ–°ä¸Šä¼ æ–‡ä»¶"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-indigo-50/50 p-2 rounded-2xl border border-indigo-100",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsx("input",{type:"text",placeholder:"æœç´¢å§“åæˆ–è¾…å¯¼è€å¸ˆ...",value:n,onChange:c=>a(c.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 placeholder-indigo-300 focus:outline-none focus:ring-0 font-medium transition-all"})]}),e.jsxs("div",{className:"relative min-w-[200px]",children:[e.jsx(fe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsxs("select",{value:l,onChange:c=>i(c.target.value),className:"w-full pl-12 pr-10 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 font-medium appearance-none focus:outline-none focus:ring-0 cursor-pointer transition-all",children:[e.jsx("option",{value:"all",children:"æ‰€æœ‰å¹´çº§"}),j.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-indigo-50/50 border-b border-indigo-100 text-indigo-400 uppercase font-bold text-xs tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-5",children:"å­¦ç”Ÿå§“å"}),e.jsx("th",{className:"px-6 py-5",children:"å¹´çº§"}),e.jsx("th",{className:"px-6 py-5",children:"è¾…å¯¼è€å¸ˆ"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"è®°å½•æ•°"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"æœ€æ–°è¿›åº¦"}),e.jsx("th",{className:"px-6 py-5 text-right",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"divide-y divide-indigo-50",children:m.length>0?m.map(c=>e.jsxs("tr",{className:"hover:bg-indigo-50/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("div",{className:"font-bold text-lg text-indigo-900",children:c.name})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-600",children:[e.jsx(ze,{className:"w-3.5 h-3.5"}),c.grade]})}),e.jsx("td",{className:"px-6 py-5 font-medium text-gray-600",children:c.teacher}),e.jsx("td",{className:"px-6 py-5 text-center font-bold text-indigo-300",children:c.unitCount}),e.jsxs("td",{className:"px-6 py-5 text-center font-medium text-gray-500",children:["ç¬¬ ",c.lastUnit," å•å…ƒ"]}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsxs("button",{onClick:()=>r(c.name),className:"inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-xs px-5 py-2.5 rounded-full transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:["ç”ŸæˆæŠ¥å‘Š",e.jsx(Ve,{className:"w-3.5 h-3.5"})]})})]},c.name)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-400",children:[e.jsx("div",{className:"text-4xl",children:"ğŸ¤”"}),e.jsx("div",{className:"font-medium",children:"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­¦ç”Ÿæ•°æ®"})]})})})})]})}),e.jsx("div",{className:"bg-indigo-50/30 px-6 py-4 border-t border-indigo-100 text-xs font-bold text-indigo-300 flex justify-between",children:e.jsxs("span",{children:["æ˜¾ç¤º ",m.length," / ",p.length," ä½å­¦ç”Ÿ"]})})]})]})},q={UNIT_NAMES:"xueqiu_custom_unit_names",ASSOCIATIONS:"xueqiu_custom_associations",KP_COUNTS:"xueqiu_custom_kp_counts",ERROR_COUNTS:"xueqiu_custom_error_counts"};function ht(){const[s,r]=h.useState("upload"),[o,n]=h.useState("counselor"),[a,l]=h.useState([]),[i,p]=h.useState(null),[j,m]=h.useState(null),[c,y]=h.useState([]),[f,v]=h.useState({min:1,max:1}),[A,M]=h.useState("default"),[x,b]=h.useState(Object.keys(be)[0]),[k,u]=h.useState(!1),[S,R]=h.useState("accuracy"),[F,C]=h.useState(()=>{const N=localStorage.getItem(q.UNIT_NAMES);return N?JSON.parse(N):[]}),[g,d]=h.useState(()=>{const N=localStorage.getItem(q.ASSOCIATIONS);return N?JSON.parse(N):[]}),[E,H]=h.useState(()=>{const N=localStorage.getItem(q.KP_COUNTS);return N?JSON.parse(N):[]}),[_,O]=h.useState(()=>{const N=localStorage.getItem(q.ERROR_COUNTS);return N?JSON.parse(N):[]});h.useEffect(()=>{localStorage.setItem(q.UNIT_NAMES,JSON.stringify(F)),localStorage.setItem(q.ASSOCIATIONS,JSON.stringify(g)),localStorage.setItem(q.KP_COUNTS,JSON.stringify(E)),localStorage.setItem(q.ERROR_COUNTS,JSON.stringify(_))},[F,g,E,_]);const Y=N=>{l(N),r("list")},Z=N=>{const $=at(a,N);if($.length===0)return alert("è¯¥å­¦ç”Ÿæ²¡æœ‰æœ‰æ•ˆæ•°æ®");const P=$[0],G=$[$.length-1];y($),v({min:P,max:G}),m(N);const U=a.find(L=>L.real_name===N);if(U){const L=U.package_grade||"",V=L.toLowerCase().includes("one")?"ä¸€å¹´çº§":L.toLowerCase().includes("two")?"äºŒå¹´çº§":L.toLowerCase().includes("three")?"ä¸‰å¹´çº§":L.toLowerCase().includes("four")?"å››å¹´çº§":L.toLowerCase().includes("five")?"äº”å¹´çº§":L.toLowerCase().includes("six")?"å…­å¹´çº§":"";V&&!x.startsWith(V)&&b(V)}const z=he(a,N,o,{min:P,max:G});z&&(p(z),r("report"))},X=N=>{const $=a.find(P=>String(P.user_id)===String(N));$?Z($.real_name):alert(`æœªæ‰¾åˆ° ID ä¸º ${N} çš„å­¦å‘˜`)},ee=(N,$)=>{if(!j)return;v({min:N,max:$});const P=he(a,j,o,{min:N,max:$});P&&p(P)},J=()=>{l([]),p(null),m(null),r("upload")};return e.jsxs("div",{className:"min-h-screen pb-10 bg-slate-50 font-sans",children:[e.jsx("header",{className:"bg-white border-b-4 border-indigo-100 py-4 mb-8 shadow-sm print:hidden",children:e.jsx("div",{className:"container mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2",children:[e.jsx("h1",{className:"text-2xl font-black text-indigo-600 flex items-center gap-2 cursor-pointer",onClick:J,children:"ğŸ“ å­¦æƒ…åé¦ˆç”Ÿæˆå™¨"}),e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"ä½¿ç”¨é—®é¢˜å¯ç•™è¨€sundong@xueqiulearning.com"})]})})}),e.jsxs("main",{className:"container mx-auto px-4",children:[s==="upload"&&e.jsx(it,{onDataLoaded:Y,role:o,onRoleChange:n}),s==="list"&&e.jsx(mt,{data:a,onSelectStudent:Z,onReupload:J}),s==="report"&&i&&e.jsx(xt,{data:i,rawData:a,onReset:J,onBack:()=>r("list"),availableUnits:c,currentRange:f,onRangeChange:ee,currentTheme:A,onThemeChange:M,selectedCurriculumKey:x,setSelectedCurriculumKey:b,onSwitchStudentById:X,isChartZoomed:k,onToggleZoom:()=>u(!k),trendMetric:S,onToggleMetric:N=>R(N),customUnitNames:F,onUpdateCustomUnitNames:C,customAssociations:g,onUpdateCustomAssociations:d,customKPCounts:E,onUpdateCustomKPCounts:H,customErrorCounts:_,onUpdateCustomErrorCounts:O})]})]})}const Ne=document.getElementById("root");if(!Ne)throw new Error("Could not find root element to mount to");const ut=ke.createRoot(Ne);ut.render(e.jsx(Ce.StrictMode,{children:e.jsx(ht,{})}));
