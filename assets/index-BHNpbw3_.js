import{r as m,F as e,G as $e,H as Ae,R as Me}from"./vendor-base-DBvmmGl1.js";import{r as Te,u as Re}from"./vendor-xlsx-BUW7exb-.js";import{C as Be,U as fe,a as Ie,F as Ee,A as Le,S as pe,P as Oe,b as be,c as Ue,I as Pe,X as Fe,B as De,Z as ae,T as de,d as qe,e as He,R as re,f as Ke,g as We,h as ze,i as se,j as Ge,k as Je,L as Ve,M as Ye,l as Ze,m as Xe,n as Qe,o as et,G as tt,p as st}from"./vendor-icons-BXfgxdot.js";import{R as at,L as nt,C as rt,X as lt,Y as it,T as ot,a as xe}from"./vendor-charts-BpewqmZv.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function i(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(a){if(a.ep)return;a.ep=!0;const n=i(a);fetch(a.href,n)}})();const we={ä¸€å¹´çº§:["åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘åˆæ­¥","åº”ç”¨é¢˜â€”â€”æ¯”è¾ƒå¤šå°‘è¿›é˜¶","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],ä¸€å¹´çº§å¼¹çª—:["ç©ºé—´æƒ³è±¡â€”â€”æ­£æ–¹ä½“è®¡æ•°","ç©ºé—´æƒ³è±¡â€”â€”æ•°æ•°çœ‹ä¸è§","é€»è¾‘æ¨ç†â€”â€”é¡ºåº","é€»è¾‘æ¨ç†â€”â€”ä¸ç­‰","é€»è¾‘æ¨ç†â€”â€”ç›¸ç­‰"],äºŒå¹´çº§:["åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¤æ‚çš„æ’é˜Ÿé—®é¢˜è¿›é˜¶","åº”ç”¨é¢˜â€”â€”è¿˜åŸå€’æ¨","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œåˆæ­¥","æ•°æ„Ÿâ€”â€”æ¨ªå¼æ•°å­—è°œè¿›é˜¶"],ä¸‰å¹´çº§:["åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜åˆæ­¥","åº”ç”¨é¢˜â€”â€”å¹´é¾„é—®é¢˜è¿›é˜¶","è½¬åŒ–æ€æƒ³â€”å·§æ±‚æœ€çŸ­è·¯çº¿","è®¡ç®—â€”â€”å·§å¡«ç®—ç¬¦","è®¡ç®—â€”â€”å·§è§£æ•´æ•°è®¡ç®—"],å››å¹´çº§:["ç›ˆäºé—®é¢˜","ç”Ÿæ´»ä¸­çš„è®¡æ•°åŸç†","å›¾å½¢ä¸­çš„è®¡æ•°åŸç†","é•¿æ–¹å½¢ä¸­çš„å€æ•°å…³ç³»","æ•°å½¢ç»“åˆ"],äº”å¹´çº§:["åŸºç¡€è¡Œç¨‹é—®é¢˜","ç¯å½¢è·¯çº¿é—®é¢˜","ç«è½¦è¡Œç¨‹é—®é¢˜","å°æ•°ä¹˜é™¤æ³•å·§ç®—","å°æ•°æå–å…¬å› æ•°"],å…­å¹´çº§:["é—´éš”å‘è½¦é—®é¢˜","ç‰¹æ®Šæ³•æ¯”è¾ƒåˆ†æ•°å¤§å°","æ“ä½œä¸è§„å¾‹","ä¸å®šæ–¹ç¨‹","çŸ­é™¤æ¨¡å‹"]},ct=s=>{if(!s||isNaN(s))return"0åˆ†é’Ÿ";const r=Math.floor(s/3600),i=s%3600,l=Math.ceil(i/60);return r>0?`${r}å°æ—¶${l>0?` ${l}åˆ†é’Ÿ`:""}`:`${l}åˆ†é’Ÿ`},E=s=>{if(s==null)return 0;if(typeof s=="number")return s*100;if(typeof s=="string"){if(s.includes("%"))return parseFloat(s.replace("%",""));const r=parseFloat(s);return r<=1?r*100:r}return 0},te=s=>{if(typeof s=="number")return s;if(!s)return 0;const r=String(s).trim();if(r.includes("åˆ†")||r.includes("ç§’")){let l=0;const a=r.match(/(\d+)\s*åˆ†/),n=r.match(/(\d+)\s*ç§’/);return a&&(l+=parseInt(a[1],10)*60),n&&(l+=parseInt(n[1],10)),l}const i=parseFloat(r);return isNaN(i)?0:i},le=s=>{if(!s)return"æœªçŸ¥å¹´çº§";const r={pk:"å¹¼å„¿å›­å°ç­",k:"å¹¼å„¿å›­å¤§ç­",one:"ä¸€å¹´çº§",two:"äºŒå¹´çº§",three:"ä¸‰å¹´çº§",four:"å››å¹´çº§",five:"äº”å¹´çº§",six:"å…­å¹´çº§"},i=s.toLowerCase().trim();if(r[i])return r[i];const l=Object.keys(r).find(a=>i.includes(a));return l?r[l]:s},dt=(s,r)=>{const i=new Set;return s.forEach(l=>{if(l.real_name===r){const a=parseInt(String(l.level_sequence),10);isNaN(a)||i.add(a)}}),Array.from(i).sort((l,a)=>l-a)},xt=s=>{if(!s||s.length===0)return{valid:!1,error:"æ–‡ä»¶ä¸ºç©º"};const r=s[0],l=["real_name","level_sequence","unit_sequence","unit_finish_status","answer_right_rate","first_cost_seconds"].filter(a=>!(a in r));return l.length>0?{valid:!1,error:`ç¼ºå°‘å¿…è¦å­—æ®µ: ${l.join(", ")}`}:{valid:!0}},me=s=>s>=4?{name:"é‡‘ç‰Œå®Œè¯¾ç‹",type:"completion",level:"gold",description:"é‡‘ç‰Œæˆå°±è¾¾æˆï¼å…¨è¯¾ç¨‹é€šå…³ï¼Œä½ å°±æ˜¯å­¦ä¹ ç‹è€…ï¼"}:{name:"å­¦ä¹ ä¹‹æ˜Ÿ",type:"completion",level:"star",description:"å­¦ä¹ ä¹‹æ˜Ÿå·²ç‚¹äº®ï¼è¡¨ç°éå¸¸äº®çœ¼ï¼ŒåŠ æ²¹å‘å‰å†²ï¼"},ue=s=>s>=90?{name:"å­¦ä¹ å…¸èŒƒ",type:"accuracy",level:"model",description:"ä½ çš„å­¦ä¹ è´¨é‡æé«˜ï¼Œå±•ç°å…¸èŒƒçº§çš„æŒæ¡åŠ›ã€‚"}:{name:"ç¨³å®šé«˜æ‰‹",type:"accuracy",level:"master",description:"ç¨³å®šä¸”æ‰å®ï¼Œä¿æŒè¿™ä¸ªèŠ‚å¥ï¼"},he=(s,r,i,l)=>{var j,f,c,y;if(!s||s.length===0)return null;const a=s.filter(g=>g.real_name===r);if(a.length===0)return null;const n=[],o=l?l.max:Math.max(...a.map(g=>parseInt(String(g.level_sequence),10))),d=a.filter(g=>parseInt(String(g.level_sequence),10)===o);if(i==="headteacher"){d.forEach(u=>{const S=parseInt(String(u.unit_sequence),10),L=E(u.answer_right_rate),H=E(u.pass_rate),_=s.filter(k=>parseInt(String(k.level_sequence),10)===o&&parseInt(String(k.unit_sequence),10)===S),p=_.filter(k=>E(k.answer_right_rate)>0),x=p.length>0?p.reduce((k,R)=>k+E(R.answer_right_rate),0)/p.length:0,O=_.filter(k=>E(k.pass_rate)>0),K=O.length>0?O.reduce((k,R)=>k+E(R.pass_rate),0)/O.length:0,P=_.filter(k=>te(k.first_cost_seconds)>0),G=P.length>0?P.reduce((k,R)=>k+te(R.first_cost_seconds),0)/P.length:0;n.push({unitNumber:S,unitName:S===0?"è¯¾å‰æµ‹":`ç¬¬${S}è®²`,timeSpentSeconds:te(u.first_cost_seconds),classTimeSpentSeconds:G,status:u.unit_finish_status==="å®Œè¯¾"?"high":"low",statusLabel:u.unit_finish_status==="å®Œè¯¾"?"å·²å®Œæˆ":"å­¦ä¹ ä¸­",accuracy:L,classAccuracy:x,passRate:H,classPassRate:K,wrongCount:parseInt(String(u.first_finish_answer_step_fail_cnt??u.wrong_answer_count??0)),analysis:""})}),n.sort((u,S)=>u.unitNumber-S.unitNumber);const g=n.find(u=>u.unitNumber===0);let v=0,M=0,T=0,h=0;n.forEach(u=>{u.unitNumber!==0&&(g&&u.accuracy>g.accuracy&&v++,u.status==="high"&&M++,u.timeSpentSeconds>0&&u.timeSpentSeconds<u.classTimeSpentSeconds&&T++,u.accuracy>=50&&h++)});const w=[{name:"å­¦ä¹ è¿›æ­¥å¾½ç« ",type:"accuracy",level:"progress",description:"æ¯ä¸€æ¬¡çªç ´ï¼Œéƒ½æ˜¯å¯¹è‡ªæˆ‘çš„è¶…è¶Šï¼Œä½ æ˜¯æœ€æ£’çš„è¿›æ­¥å°è¾¾äººï¼",stars:Math.min(5,v)},{name:"åšæŒå°è¾¾äºº",type:"completion",level:"growth",description:"æ»´æ°´ç©¿çŸ³ï¼Œä½ çš„æ¯ä¸€ä»½åšæŒéƒ½åœ¨ä¸ºæˆåŠŸçš„æœªæ¥é“ºè·¯ï¼Œç»§ç»­ä¿æŒï¼",stars:Math.min(5,M)},{name:"æ—¶é—´å°é£ä¾ ",type:"accuracy",level:"potential",description:"çµåŠ¨å¦‚é—ªç”µï¼Œä½ çš„é«˜æ•ˆæ€ç»´è®©å­¦ä¹ å˜å¾—å¦‚æ­¤è½»æ¾ï¼Œä¸ºä½ ç‚¹èµï¼",stars:Math.min(5,T)},{name:"æ»¡åˆ†å†²åˆºæ˜Ÿ",type:"accuracy",level:"master",description:"ç„å‡†ç›®æ ‡ï¼Œå…¨åŠ›ä»¥èµ´ï¼Œä½ çš„ä¸“æ³¨è®©æ¯ä¸€ä¸ªå…³å¡éƒ½å˜å¾—ç®€å•ï¼",stars:Math.min(5,h)}],C=n.reduce((u,S)=>u+S.timeSpentSeconds,0);return{studentName:r,grade:le((j=a[0])==null?void 0:j.package_grade),teacher:((f=a[0])==null?void 0:f.counselor_name)||"è€å¸ˆ",role:i,totalTimeSeconds:C,avgTimePerSession:C/(n.length||1),timeComment:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼",completionBadge:me(0),accuracyBadge:ue(0),htBadges:w,completedUnitsCount:n.filter(u=>u.status==="high").length,units:n,trendAnalysis:mt(n),errorAnalysis:ut(n),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}else{const g=new Map;a.forEach(h=>{const w=parseInt(String(h.level_sequence),10);if(l&&(w<l.min||w>l.max))return;g.has(w)||g.set(w,{unitNumber:w,unitName:`ç¬¬${w}å•å…ƒ`,timeSpentSeconds:0,classTimeSpentSeconds:0,status:"low",statusLabel:"å­¦ä¹ ä¸­",accuracy:0,classAccuracy:0,passRate:0,classPassRate:0,wrongCount:0,analysis:""});const C=g.get(w);C.timeSpentSeconds+=te(h.first_cost_seconds),C.accuracy=(C.accuracy+E(h.answer_right_rate))/2,C.passRate=(C.passRate+E(h.pass_rate))/2,h.unit_finish_status==="å®Œè¯¾"&&(C.status="high")});const v=Array.from(g.values()).sort((h,w)=>h.unitNumber-w.unitNumber);v.forEach(h=>{const w=s.filter(S=>parseInt(String(S.level_sequence),10)===h.unitNumber),C=w.filter(S=>E(S.answer_right_rate)>0);h.classAccuracy=C.length>0?C.reduce((S,L)=>S+E(L.answer_right_rate),0)/C.length:0;const u=w.filter(S=>E(S.pass_rate)>0);h.classPassRate=u.length>0?u.reduce((S,L)=>S+E(L.pass_rate),0)/u.length:0,h.status==="high"&&(h.analysis=h.accuracy>=h.classAccuracy?"æŒæ¡æ‰å®ï¼Œè¶…è¶Šå¹³å‡":"æ€åº¦è®¤çœŸï¼Œè¯·å·©å›ºé”™é¢˜")});const M=v.reduce((h,w)=>h+w.timeSpentSeconds,0),T=v.reduce((h,w)=>h+w.accuracy,0)/(v.length||1);return{studentName:r,grade:le((c=a[0])==null?void 0:c.package_grade),teacher:((y=a[0])==null?void 0:y.counselor_name)||"è€å¸ˆ",role:i,totalTimeSeconds:M,avgTimePerSession:M/(v.length||1),timeComment:"å­¦ä¹ æ•ˆç‡å¾ˆé«˜ï¼Œè¡¨ç°å‡ºè‰²ã€‚",completionBadge:me(v.filter(h=>h.status==="high").length),accuracyBadge:ue(T),completedUnitsCount:v.filter(h=>h.status==="high").length,units:v,trendAnalysis:ht(v),monthlySummary:{milestone:"",highlights:[],improvements:[]}}}};function mt(s){const r=s.find(n=>n.unitNumber===0),i=s.filter(n=>n.unitNumber>0).sort((n,o)=>n.unitNumber-o.unitNumber);if(i.length===0)return{status:"stable",title:"å¼€å¯æŒ‘æˆ˜",content:"å®è´å·²å‡†å¤‡å°±ç»ªï¼ŒæœŸå¾…å¼€å¯ç²¾å½©çš„æ€ç»´é—¯å…³ä¹‹æ—…ï¼"};const l=i[i.length-1];let a=i.length>=2;for(let n=1;n<i.length;n++)if(i[n].accuracy<=i[n-1].accuracy){a=!1;break}if(a)return{status:"rising",title:"å®Œç¾çš„é˜¶æ¢¯å¼æˆé•¿",content:`å®Œç¾çš„é˜¶æ¢¯å¼æˆé•¿ï¼è¯¾ç¨‹è®¾è®¡çš„æ¯ä¸€æ­¥æŒ‘æˆ˜ï¼Œå­©å­éƒ½æ­¥æ­¥ä¸ºè¥ï¼Œæ­£ç¡®ç‡ä»${i[0].accuracy.toFixed(0)}%ä¸€è·¯ç¨³å®šå‡è‡³${l.accuracy.toFixed(0)}%ã€‚è¿™æ­£æ˜¯ç§‘å­¦å­¦ä¹ è·¯å¾„ä¸å­©å­åŠªåŠ›åŒé¢‘å…±æŒ¯çš„è¯æ˜ã€‚`};if(r){const n=r.accuracy.toFixed(0),o=l.accuracy.toFixed(0),d=Math.abs(l.accuracy-r.accuracy).toFixed(0),j=l.unitNumber;return l.accuracy>r.accuracy?{status:"improving",title:"è¿›æ­¥è·¨è¶Šï¼Œè¡¨ç°äº®çœ¼",content:`å¤ªæ£’äº†ï¼å¯¹æ¯”è¯¾å‰æµ‹ï¼ˆæ­£ç¡®ç‡${n}%ï¼‰ï¼Œå®è´åœ¨ç¬¬${j}è¯¾çš„æ­£ç¡®ç‡å·²æå‡è‡³ ${o}%ï¼Œ${d}ä¸ªç™¾åˆ†ç‚¹çš„è·¨è¶Šæ¸…æ™°å±•ç°äº†è¿›æ­¥ï¼`}:{status:"potential",title:"åšæŒæ€è€ƒï¼Œæ½œåŠ›æ— é™",content:`å€¼å¾—ç‚¹èµï¼ä»è¯¾å‰åˆ°ç¬¬${j}èŠ‚è¯¾çš„å…¨ç¨‹å­¦ä¹ ï¼Œå®è´å±•ç°äº†å‡ºè‰²çš„åšæŒä¸æ€è€ƒä¹ æƒ¯ã€‚é¢å¯¹ä¸æ–­å‡çº§çš„æŒ‘æˆ˜ä»å…´è¶£ç›ç„¶ï¼Œè¿™ä»½ä¸“æ³¨åŠ›æ˜¯æœªæ¥çªç ´çš„æœ€å¤§æ½œåŠ›ã€‚`}}return{status:"stable",title:"ä¿æŒçŠ¶æ€",content:"å±•ç°äº†å‡ºè‰²çš„å­¦ä¹ ä¹ æƒ¯ï¼Œé¢å¯¹æŒ‘æˆ˜æ¯«ä¸é€€ç¼©ã€‚ä¿æŒè¿™ä»½ä¸“æ³¨åŠ›ï¼Œä¸‹ä¸€æ¬¡çªç ´å°±åœ¨çœ¼å‰ï¼"}}function ut(s){const r=s.find(n=>n.unitNumber===0),i=s.filter(n=>n.unitNumber>0).sort((n,o)=>n.unitNumber-o.unitNumber);if(i.length===0)return{status:"stable",title:"å­¦ä¹ è¶³è¿¹",content:"æš‚æ— è®°å½•ï¼ŒæœŸå¾…å®è´ç²¾å½©è¡¨ç°ã€‚"};const l=i[i.length-1];let a=i.length>=2;for(let n=1;n<i.length;n++)if(i[n].wrongCount>=i[n-1].wrongCount){a=!1;break}if(a)return{status:"success",title:"æ­¥æ­¥ä¸ºè¥ï¼Œé£é€Ÿè¿›æ­¥",content:"æ­¥æ­¥ä¸ºè¥ï¼Œé”™é¢˜æŒç»­å‡å°‘ï¼Œå­¦ä¹ ä¹ æƒ¯ä¸æ•ˆæœä¿±ä½³ï¼Œè¿›æ­¥é£é€Ÿï¼"};if(r){if(l.wrongCount<r.wrongCount)return{status:"improving",title:"æˆæ•ˆæ˜¾è‘—",content:"é”™é¢˜æ—¥ç›Šå‡å°‘ï¼Œå¯è§çŸ¥è¯†æŒæ¡è¶Šå‘æ‰å®ç‰¢å›ºï¼"};if(l.wrongCount>r.wrongCount)return{status:"extension",title:"æ€ç»´æ‹“å±•",content:"æŒ‘æˆ˜å‡çº§ï¼Œæ•¢äºå°è¯•å¤æ‚é¢˜ç›®ï¼Œæ­£æ˜¯æ€ç»´æ·±å…¥æ‹“å±•çš„è¡¨ç°ï¼"}}return{status:"stable",title:"ä¸“æ³¨æ”»å…‹",content:"æ¯ä¸€é“é”™é¢˜çš„è®¢æ­£éƒ½æ˜¯ä¸€æ¬¡æ€ç»´çš„é‡å¡‘ï¼Œä¿æŒè¿™ç§è®¤çœŸçš„å­¦ä¹ æ€åº¦ã€‚"}}function ht(s){if(s.length===0)return{status:"stable",title:"ç¨³æ­¥æå‡",content:"ç»§ç»­ä¿æŒè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼"};const r=s[0],i=s[s.length-1],l=s.every(n=>n.accuracy>=n.classAccuracy),a=i.accuracy>r.accuracy;return l&&a?{status:"rising",title:"æŒç»­é¢†å…ˆä¸”ä¸Šå‡",content:"è¡¨ç°ä¼˜ç§€ä¸”æŒç»­è¿›æ­¥ï¼å„å•å…ƒæ­£ç¡®ç‡å‡é«˜äºç­çº§å¹³å‡æ°´å¹³å¹¶ç¨³æ­¥ä¸Šå‡ã€‚"}:l?{status:"above",title:"æ•´ä½“é¢†å…ˆ",content:"æ•´ä½“è¡¨ç°ç¨³å®šé¢†å…ˆï¼åŸºç¡€æ‰å®ï¼Œä¿æŒè¿™ä¸ªèŠ‚å¥ã€‚"}:{status:"stable",title:"ç´§è·Ÿæ­¥ä¼",content:"è¡¨ç°ç¨³å®šï¼Œè·Ÿç´§ç­çº§æ­¥ä¼ï¼Œçªç ´è–„å¼±ç¯èŠ‚æœ‰æœ›å®ç°é¢†å…ˆã€‚"}}const gt=s=>{const r=new Map;return s.forEach(i=>{r.has(i.real_name)||r.set(i.real_name,{name:i.real_name,grade:le(i.package_grade),teacher:i.counselor_name,unitCount:0,lastUnit:0});const l=r.get(i.real_name);l.unitCount++,l.lastUnit=Math.max(l.lastUnit,parseInt(String(i.level_sequence),10))}),Array.from(r.values())},ft=({onDataLoaded:s,role:r,onRoleChange:i})=>{const[l,a]=m.useState(null),[n,o]=m.useState(!1),d=c=>{a(null);const y=new FileReader;y.onload=g=>{var v;try{const M=(v=g.target)==null?void 0:v.result,T=Te(M,{type:"binary"}),h=T.Sheets[T.SheetNames[0]],w=Re.sheet_to_json(h),C=xt(w);if(!C.valid)return a(C.error||"æ— æ•ˆæ–‡ä»¶");s(w)}catch{a("è§£ææ–‡ä»¶å‡ºé”™")}},y.readAsBinaryString(c)},j=c=>{c.preventDefault(),o(c.type==="dragenter"||c.type==="dragover")},f=c=>{var y;c.preventDefault(),o(!1),(y=c.dataTransfer.files)!=null&&y[0]&&d(c.dataTransfer.files[0])};return e.jsxs("div",{className:"max-w-2xl mx-auto mt-12 space-y-6",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-2",children:[e.jsxs("button",{onClick:()=>i("counselor"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${r==="counselor"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx(Be,{className:"w-5 h-5"})," è¯¾å¯¼æ¨¡å¼"]}),e.jsxs("button",{onClick:()=>i("headteacher"),className:`flex items-center gap-2 px-8 py-3 rounded-2xl font-black transition-all ${r==="headteacher"?"bg-indigo-600 text-white shadow-lg scale-105":"bg-white text-indigo-300 border-2 border-indigo-50 hover:bg-indigo-50"}`,children:[e.jsx(fe,{className:"w-5 h-5"})," ç­ä¸»ä»»æ¨¡å¼"]})]}),e.jsx("div",{className:`p-10 bg-white rounded-[2.5rem] shadow-xl border-4 border-dashed transition-all
          ${n?"border-indigo-400 bg-indigo-50":"border-slate-100"}
          ${l?"border-red-200 bg-red-50":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:f,children:e.jsxs("div",{className:"flex flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:`p-6 rounded-full shadow-sm ${l?"bg-red-100":"bg-indigo-100"}`,children:e.jsx(Ie,{className:`w-12 h-12 ${l?"text-red-500":"text-indigo-500"}`})}),e.jsx("h2",{className:"text-3xl font-black text-slate-800",children:"ä¸Šä¼ å­¦ä¹ æ•°æ® Excel"}),e.jsx("p",{className:"text-slate-400 font-bold max-w-sm",children:"è¯·ä¸Šä¼ ç­çº§å­¦ä¹ è®°å½•è¡¨æ ¼ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ ¹æ®æ‰€é€‰èº«ä»½ç”Ÿæˆç²¾ç¾æŠ¥å‘Š"}),e.jsxs("label",{className:"cursor-pointer bg-slate-800 hover:bg-slate-900 text-white font-black px-12 py-4 rounded-3xl transition-all shadow-xl hover:-translate-y-1 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-6 h-6"})," é€‰æ‹©æ–‡ä»¶",e.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:c=>{var y;return((y=c.target.files)==null?void 0:y[0])&&d(c.target.files[0])}})]})]})})]})},pt=({data:s,color:r="#f97316",isZoomed:i=!1,metric:l="accuracy"})=>{const a=l,n=l==="accuracy"?"classAccuracy":"classPassRate",o=l==="accuracy"?"ä½œç­”æ­£ç¡®ç‡":"è¿‡å…³ç‡",d=s.map(f=>({name:f.unitNumber,displayOrder:String(f.unitNumber),fullName:f.unitName,value:f[a],classAverage:f[n]})),j=()=>{if(!i||d.length===0)return[0,100];const f=d.flatMap(g=>[g.value,g.classAverage]).filter(g=>typeof g=="number");if(f.length===0)return[0,100];const c=Math.min(...f);return[Math.max(0,Math.floor(c-5)),100]};return e.jsx("div",{className:"w-full h-full flex flex-col font-sans",children:e.jsx("div",{className:"flex-grow min-h-0",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(nt,{data:d,margin:{top:20,right:30,left:0,bottom:20},children:[e.jsx(rt,{strokeDasharray:"3 3",vertical:!1,stroke:"#e7e5e4"}),e.jsx(lt,{dataKey:"displayOrder",tick:{fontSize:12,fill:"#78716c",fontWeight:800},axisLine:!1,tickLine:!1,padding:{left:20,right:20}}),e.jsx(it,{domain:j(),tick:{fontSize:12,fill:"#78716c",fontWeight:700},axisLine:!1,tickLine:!1,width:35}),e.jsx(ot,{formatter:(f,c)=>[`${f.toFixed(1)}%`,c==="value"?`æˆ‘çš„${o}`:`ç­çº§å¹³å‡${o}`],contentStyle:{borderRadius:"16px",border:`2px solid ${r}`,backgroundColor:"#fff",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",fontFamily:"Nunito, sans-serif",color:"#44403c",fontWeight:"bold"},labelFormatter:f=>`ç¬¬ ${f} å•å…ƒ`,cursor:{stroke:r,strokeWidth:2,strokeDasharray:"4 4"}}),e.jsx(xe,{type:"monotone",dataKey:"classAverage",name:"classAverage",stroke:"#cbd5e1",strokeWidth:4,strokeDasharray:"8 8",dot:{r:0},activeDot:!1}),e.jsx(xe,{connectNulls:!0,type:"monotone",dataKey:"value",name:"value",stroke:r,strokeWidth:5,dot:{r:6,fill:"#fff",stroke:r,strokeWidth:4},activeDot:{r:9,fill:r,stroke:"#fff",strokeWidth:3}})]})})})})},ne={default:{id:"default",label:"ç»å…¸æš–é˜³",icon:e.jsx(se,{className:"w-4 h-4"}),containerClass:"rounded-[3.5rem] border-[6px] shadow-2xl",cardClass:"rounded-[2rem] border-2 shadow-sm",headerClass:"border-b-4",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/confetti.png",colors:{bgMain:"bg-white",textMain:"text-stone-700",textMuted:"text-stone-400",headerBg:"bg-[#FFF8E1]",headerText:"text-amber-800",primary:"bg-amber-400 hover:bg-amber-500 text-white shadow-[0_4px_0_#d97706]",secondary:"bg-white border-2 border-stone-200 text-stone-400 hover:border-red-200 hover:text-red-500",border:"border-amber-100",profileBg:"bg-sky-50",badgesBg:"bg-[#fffbf0]",statsBg:"bg-stone-50",chartBg:"bg-[#fffaf5]",tableHeader:"bg-stone-50 text-stone-500",teacherSection:"bg-sky-50 border-amber-100",rankingHeaderBg:"bg-blue-50 border-blue-100",rankingHighlightRow:"bg-amber-50",rankingBannerBg:"bg-[#ff8a80]",rankingBannerText:"text-white"}},boy:{id:"boy",label:"æ˜Ÿé™…æ¢ç´¢",icon:e.jsx(re,{className:"w-4 h-4"}),containerClass:"rounded-[3rem] border-[5px] shadow-[0_10px_50px_rgba(59,130,246,0.15)]",cardClass:"rounded-[2.5rem] border-2 border-b-4",headerClass:"border-b-4 border-blue-900/10",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/cubes.png",colors:{bgMain:"bg-slate-50",textMain:"text-slate-800",textMuted:"text-slate-400",headerBg:"bg-blue-100",headerText:"text-blue-900",primary:"bg-blue-600 hover:bg-blue-700 text-white shadow-[0_4px_0_#1e3a8a]",secondary:"bg-white border-2 border-slate-300 text-slate-500 hover:border-blue-500 hover:text-blue-600",border:"border-blue-200",profileBg:"bg-white",badgesBg:"bg-gradient-to-br from-blue-50 to-slate-100",statsBg:"bg-slate-100",chartBg:"bg-white",tableHeader:"bg-slate-200 text-slate-600 uppercase tracking-wider",teacherSection:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white border-none",rankingHeaderBg:"bg-blue-100 border-blue-200",rankingHighlightRow:"bg-blue-50",rankingBannerBg:"bg-blue-500",rankingBannerText:"text-white"}},girl:{id:"girl",label:"æ¢¦å¹»äº‘æœµ",icon:e.jsx(et,{className:"w-4 h-4"}),containerClass:"rounded-[4rem] border-[8px] border-double shadow-2xl ring-8 ring-rose-50",cardClass:"rounded-[2.5rem] border-2 border-dashed shadow-[4px_4px_0px_rgba(253,164,175,0.3)]",headerClass:"border-b-[3px] border-dashed",showPattern:!0,backgroundPattern:"https://www.transparenttextures.com/patterns/hearts.png",colors:{bgMain:"bg-[#fffcfd]",textMain:"text-stone-600",textMuted:"text-rose-200",headerBg:"bg-rose-50",headerText:"text-stone-700",primary:"bg-rose-200 hover:bg-rose-300 text-stone-700 shadow-[0_4px_0_#fda4af]",secondary:"bg-white/80 border-2 border-rose-100 text-rose-300 hover:bg-white",border:"border-rose-100",profileBg:"bg-white/60 backdrop-blur-sm",badgesBg:"bg-gradient-to-b from-rose-50/20 to-white/50",statsBg:"bg-rose-50/40",chartBg:"bg-white/60",tableHeader:"bg-rose-50 text-rose-300",teacherSection:"bg-stone-50 border-rose-100",rankingHeaderBg:"bg-stone-50 border-stone-100",rankingHighlightRow:"bg-rose-50",rankingBannerBg:"bg-stone-400",rankingBannerText:"text-white"}}},bt=(s,r,i,l)=>{const a=new Map;s.forEach(o=>{const d=i==="headteacher",j=parseInt(String(o.level_sequence),10),f=parseInt(String(o.unit_sequence),10);if(d){if(j!==r.max)return}else if(isNaN(j)||j<r.min||j>r.max)return;a.has(o.real_name)||a.set(o.real_name,{accuracies:{},totalScore:0,avgAccuracy:0,count:0,finishedCount:0,rowCount:0,id:o.user_id});const c=a.get(o.real_name),y=E(o.answer_right_rate);c.accuracies[f]=y,c.rowCount++,o.unit_finish_status==="å®Œè¯¾"&&c.finishedCount++});const n=Array.from(a.entries()).map(([o,d])=>{let j=0,f=0,c=0;i==="headteacher"?[0,1,2,3,4,5].forEach(g=>{d.accuracies[g]!==void 0&&(j+=d.accuracies[g])}):Object.values(d.accuracies).forEach(g=>{f+=g,c++});const y=d.rowCount>0?d.finishedCount/d.rowCount*100:0;return{name:o,userId:d.id,accuracies:d.accuracies,totalScore:Math.round(j),avgAccuracy:c>0?f/c:0,completionRate:y,rank:0}});return i==="headteacher"?n.sort((o,d)=>d.totalScore-o.totalScore):n.sort((o,d)=>d.completionRate!==o.completionRate?d.completionRate-o.completionRate:o.name===l?-1:d.name===l?1:d.avgAccuracy-o.avgAccuracy),n.forEach((o,d)=>o.rank=d+1),{rankings:n,total:n.length}},ge=[0,1,2,3,4,5],wt=({data:s,rawData:r,onBack:i,availableUnits:l,currentRange:a,onRangeChange:n,currentTheme:o,onThemeChange:d,selectedCurriculumKey:j,setSelectedCurriculumKey:f,onSwitchStudentById:c,isChartZoomed:y,onToggleZoom:g,trendMetric:v,onToggleMetric:M,customUnitNames:T,onUpdateCustomUnitNames:h,customAssociations:w,onUpdateCustomAssociations:C,customKPCounts:u,onUpdateCustomKPCounts:S,customErrorCounts:L,onUpdateCustomErrorCounts:H})=>{var ce;const _=ne[o],p=_.colors,x=s.role==="headteacher",O=m.useRef(null),[K,P]=m.useState(""),[G,k]=m.useState(!1),[R,Y]=m.useState(!1),[Z,J]=m.useState(T.join(`
`)),[b,B]=m.useState(w.join(`
`)),[F,X]=m.useState(u.join(`
`)),[V,Q]=m.useState(L.join(`
`)),U=we[j]||[],{rankings:D,total:ie}=m.useMemo(()=>bt(r,a,s.role,s.studentName),[r,a,s.role,s.studentName]),oe=D.find(t=>t.name===s.studentName),je=m.useMemo(()=>{const t=D.findIndex(N=>N.name===s.studentName);return t===-1?[]:D.slice(Math.max(0,t-5),Math.min(D.length,t+6))},[D,s.studentName]),ye=()=>{h(Z.split(`
`).map(t=>t.trim())),x||(C(b.split(`
`).map(t=>t.trim())),S(F.split(`
`).map(t=>t.trim())),H(V.split(`
`).map(t=>t.trim()))),k(!1)},ve=async()=>{if(O.current){Y(!0);try{const t={quality:1,pixelRatio:2,backgroundColor:o==="boy"?"#f8fafc":"#ffffff",style:{width:"1200px",maxWidth:"1200px",margin:"0",padding:"0",transform:"none"},preferredFontFormat:"woff2"},N=await $e(O.current,t),A=await(await fetch(N)).blob();try{await navigator.clipboard.write([new ClipboardItem({"image/png":A})]),alert("æŠ¥å‘Šå›¾ç‰‡å·²å®Œç¾ç”Ÿæˆå¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼")}catch{const z=document.createElement("a");z.download=`${s.studentName}_å­¦æƒ…æŠ¥å‘Š.png`,z.href=N,z.click(),alert("å·²æˆåŠŸç”Ÿæˆå›¾ç‰‡å¹¶å¼€å§‹ä¸‹è½½ã€‚")}}catch(t){console.error("Export error:",t),alert("æˆªå›¾ç”Ÿæˆå¤±è´¥ã€‚è¯·é‡è¯•ã€‚")}finally{Y(!1)}}},Se=t=>{if(t===0)return"è¯¾å‰æµ‹";const N=T[t-1];return N&&N.trim()?N:x&&t>=1&&t<=5?U[t-1]||`ç¬¬${t}è®²`:x?`ç¬¬${t}è®²`:`ç¬¬${t}å•å…ƒ`},Ce=t=>x||t===0?"":w[t-1]||"",W=m.useMemo(()=>s.units.map(t=>{const N=Se(t.unitNumber),$=t.status==="low"?`ã€${N}ã€‘ç­‰ä½ æŒ‘æˆ˜`:t.analysis;return{...t,unitName:N,association:Ce(t.unitNumber),analysis:$}}),[s.units,x,U,T,w]),ee=m.useMemo(()=>{if(x||W.length!==4)return null;let t=0,N=0;const $=[],A=[];return W.forEach(I=>{const z=I.unitNumber-1;t+=parseInt(u[z]||"0"),N+=parseInt(L[z]||"0"),I.accuracy>I.classAccuracy?$.push(I.unitName):A.push(I.unitName)}),{totalKPs:t,totalErrors:N,totalMinutes:Math.ceil(s.totalTimeSeconds/60),highPerformersJoined:$.join("ã€"),lowPerformersJoined:A.join("ã€")}},[x,W,u,L,s.totalTimeSeconds]),ke=t=>{if(!t)return null;const N=t.includes("é«˜é¢‘"),$=t.includes("é‡ç‚¹"),A=t.includes("æ‹“å±•")||t.includes("æ€ç»´"),I="flex items-center justify-center px-3 h-6 rounded-lg border text-[10px] font-black leading-none whitespace-nowrap";return N?e.jsxs("span",{className:`${I} bg-rose-50 text-rose-500 border-rose-200 shadow-[2px_2px_0_rgba(244,63,94,0.1)]`,children:["ğŸ”¥ ",t]}):$?e.jsx("span",{className:`${I} bg-indigo-50 text-indigo-500 border-indigo-100`,children:t}):A?e.jsxs("span",{className:`${I} bg-emerald-50 text-emerald-500 border-emerald-100`,children:["ğŸ’¡ ",t]}):e.jsx("span",{className:`${I} bg-slate-50 text-slate-400 border-slate-100`,children:t})},_e=()=>{if(!oe)return"ç»§ç»­åŠªåŠ›ï¼Œäº‰å–æ›´å¥½çš„æˆç»©ï¼";const{rank:t}=oe,N=t/(ie||1);return t===1?"ç‹¬å é³Œå¤´ï¼ä½ æ˜¯å…¨ç­æœ€é—ªäº®çš„å­¦ä¹ æ˜æ˜Ÿï¼Œå±•ç°äº†éå‡¡çš„æŒæ¡åŠ›ï¼":t<=3?"ååˆ—å‰èŒ…ï¼ä¼˜ç§€çš„å­¦ä¹ ä¹ æƒ¯æ˜¯ä½ æˆåŠŸçš„åŸºçŸ³ï¼Œä¿æŒè¿™ä»½å†²åŠ²ï¼":N<=.2?"è¡¨ç°ä¼˜å¼‚ï¼å·²è¿›å…¥ç­çº§ç¬¬ä¸€æ¢¯é˜Ÿï¼Œç»§ç»­ä¿æŒç¨³å¥çš„æ­¥ä¼ï¼Œå†²åˆºå·…å³°ï¼":N<=.5?"è¿›æ­¥æ˜¾è‘—ï¼ä½ æ­£èµ°åœ¨ç¨³æ­¥æå‡çš„é˜¶æ¢¯ä¸Šï¼Œç¦»å°–å­ç”Ÿè¡Œåˆ—ä»…ä¸€æ­¥ä¹‹é¥ï¼":"æ½œåŠ›æ— é™ï¼ä¿æŒä¸“æ³¨ä¸è€å¿ƒï¼Œæ¯ä¸€ä»½æ±—æ°´éƒ½ä¼šåœ¨æœªæ¥çš„è€ƒè¯•ä¸­å¼€å‡ºç¿çƒ‚ä¹‹èŠ±ï¼"};return e.jsxs("div",{className:`max-w-6xl mx-auto my-6 font-sans ${p.textMain}`,children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-center px-4 gap-4 print:hidden",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{onClick:i,className:"bg-white px-6 py-2.5 rounded-full border-2 border-slate-100 shadow-sm font-black flex items-center gap-2 transition-all hover:scale-105 active:scale-95",children:[e.jsx(Le,{className:"w-5 h-5"}),"åˆ—è¡¨"]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),c(K),P("")},className:"relative group",children:[e.jsx(pe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300 group-focus-within:text-indigo-400 transition-colors"}),e.jsx("input",{type:"text",value:K,onChange:t=>P(t.target.value),placeholder:"IDåˆ‡æ¢",className:"bg-white pl-10 pr-4 py-2.5 rounded-full border-2 border-slate-100 shadow-sm outline-none focus:border-indigo-100 font-bold text-sm w-32"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-center",children:[e.jsxs("button",{onClick:()=>k(!0),className:"bg-white px-4 py-2 rounded-full border-2 shadow-sm font-black text-xs flex items-center gap-2 transition-all border-slate-100 text-slate-400 hover:border-indigo-100 hover:text-indigo-600",children:[e.jsx(Oe,{className:"w-4 h-4"})," è®¾ç½®è¯¾ç¨‹ä¿¡æ¯"]}),e.jsx("div",{className:"bg-white p-1 rounded-full border-2 border-slate-100 shadow-sm flex",children:Object.keys(ne).map(t=>e.jsx("button",{onClick:()=>d(t),className:`px-4 py-1.5 rounded-full text-xs font-black transition-all ${o===t?"bg-slate-800 text-white shadow-md":"text-slate-400"}`,children:ne[t].label},t))}),!x&&e.jsxs("div",{className:"bg-white px-4 py-2 rounded-full border-2 border-slate-100 shadow-sm flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-slate-300"}),e.jsx("select",{value:a.min,onChange:t=>n(parseInt(t.target.value),a.max),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:l.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))}),e.jsx("span",{className:"text-slate-200",children:"~"}),e.jsx("select",{value:a.max,onChange:t=>n(a.min,parseInt(t.target.value)),className:"bg-transparent font-black text-sm outline-none cursor-pointer",children:l.map(t=>e.jsxs("option",{value:t,children:["ç¬¬",t,"å•å…ƒ"]},t))})]}),e.jsxs("button",{onClick:ve,disabled:R,className:`px-8 py-2.5 rounded-full font-black flex items-center gap-2 transition-all active:translate-y-1 ${R?"opacity-50 cursor-not-allowed":""} ${p.primary}`,children:[R?e.jsx(Ue,{className:"w-5 h-5 animate-spin"}):e.jsx(Pe,{className:"w-5 h-5"}),R?"æ­£åœ¨ç”Ÿæˆ...":"1:1 ç²¾å‡†å¯¼å‡º"]})]})]}),G&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[3rem] shadow-2xl overflow-hidden border-8 border-indigo-50 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-8 border-b-4 border-indigo-50 flex justify-between items-center bg-indigo-50/30",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-indigo-900",children:"è¯¾ç¨‹å…ƒæ•°æ®è®¾ç½®"}),e.jsx("p",{className:"text-slate-400 text-xs font-bold mt-1 uppercase tracking-widest",children:"Metadata Configuration"})]}),e.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-rose-50 rounded-full transition-colors text-slate-300 hover:text-rose-500",children:e.jsx(Fe,{className:"w-8 h-8"})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-black text-indigo-400 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"})," å•å…ƒ/è®² åç§° (æ¯è¡Œä¸€ä¸ª)"]}),e.jsx("textarea",{value:Z,onChange:t=>J(t.target.value),placeholder:`ç¬¬1å•å…ƒ
ç¬¬2å•å…ƒ
...`,className:"w-full h-48 bg-slate-50 border-2 border-slate-100 rounded-3xl p-6 font-bold text-sm focus:border-indigo-200 outline-none transition-all resize-none"})]}),!x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-black text-rose-400 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"})," å­¦ä¹ å…³è”/æ ‡ç­¾ (æ¯è¡Œä¸€ä¸ª)"]}),e.jsx("textarea",{value:b,onChange:t=>B(t.target.value),placeholder:`é«˜é¢‘æ˜“é”™
æ€ç»´æ‹“å±•
...`,className:"w-full h-48 bg-slate-50 border-2 border-slate-100 rounded-3xl p-6 font-bold text-sm focus:border-rose-200 outline-none transition-all resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-black text-emerald-400 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"})," çŸ¥è¯†ç‚¹æ€»æ•° (é‡Œç¨‹ç¢‘ç»Ÿè®¡)"]}),e.jsx("textarea",{value:F,onChange:t=>X(t.target.value),placeholder:`12
15
...`,className:"w-full h-32 bg-slate-50 border-2 border-slate-100 rounded-3xl p-6 font-bold text-sm focus:border-emerald-200 outline-none transition-all resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-black text-amber-400 flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"})," æ˜“é”™ç‚¹æ€»æ•° (é‡Œç¨‹ç¢‘ç»Ÿè®¡)"]}),e.jsx("textarea",{value:V,onChange:t=>Q(t.target.value),placeholder:`3
5
...`,className:"w-full h-32 bg-slate-50 border-2 border-slate-100 rounded-3xl p-6 font-bold text-sm focus:border-amber-200 outline-none transition-all resize-none"})]})]})]}),e.jsxs("div",{className:"p-8 border-t-4 border-indigo-50 bg-slate-50/50 flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-8 py-3 rounded-2xl font-black text-slate-400 hover:bg-slate-100 transition-all",children:"å–æ¶ˆä¿®æ”¹"}),e.jsxs("button",{onClick:ye,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-10 py-3 rounded-2xl font-black shadow-lg shadow-indigo-200 flex items-center gap-2 transition-all active:scale-95",children:[e.jsx(He,{className:"w-5 h-5"})," ä¿å­˜é…ç½®"]})]})]})}),e.jsxs("div",{ref:O,id:"report-container-main",className:`${p.bgMain} ${_.containerClass} ${p.border} overflow-hidden relative print:shadow-none print:border-none print:rounded-none transition-all duration-700 mx-auto print:w-full`,children:[e.jsx("div",{className:`${p.headerBg} py-12 text-center relative border-b-4 ${p.border}`,children:e.jsxs("h1",{className:`text-4xl font-black ${p.headerText} tracking-tight drop-shadow-sm flex items-center justify-center gap-3 leading-tight`,children:[o==="boy"?e.jsx(re,{className:"w-10 h-10 animate-pulse"}):e.jsx(Ke,{className:"w-10 h-10 text-yellow-300 fill-current"}),s.studentName," ",x?"ä¸“å±å­¦ä¹ æŠ¥å‘Š":`${a.min}-${a.max}å•å…ƒ å­¦ä¹ æŠ¥å‘Š`]})}),e.jsxs("div",{className:`flex flex-col md:flex-row border-b-4 ${p.border}`,children:[e.jsxs("div",{className:`w-full md:w-1/3 ${p.profileBg} p-10 border-b-4 md:border-b-0 md:border-r-4 ${p.border} flex flex-col justify-center`,children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:`w-16 h-16 rounded-3xl flex items-center justify-center border-4 shadow-sm ${o==="boy"?"bg-blue-600 text-white border-blue-200":"bg-rose-100 text-stone-500 border-white"}`,children:e.jsx(We,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-2xl leading-none",children:"å­¦å‘˜æ¡£æ¡ˆ"}),e.jsx("p",{className:"text-xs opacity-40 font-bold uppercase tracking-widest mt-1",children:"Profile Card"})]})]}),e.jsxs("div",{className:`${_.cardClass} bg-white p-8 space-y-6`,children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40 leading-none",children:"å§“å"}),e.jsx("span",{className:"font-black text-xl leading-none",children:s.studentName})]}),e.jsxs("div",{className:"flex justify-between items-center border-b pb-3",children:[e.jsx("span",{className:"font-bold opacity-40 leading-none",children:"å¹´çº§"}),e.jsx("span",{className:"flex items-center justify-center px-4 h-7 rounded-full bg-slate-100 font-bold text-sm leading-none",children:s.grade})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold opacity-40 leading-none",children:"è€å¸ˆ"}),e.jsx("span",{className:"font-bold leading-none",children:s.teacher})]})]})]}),e.jsxs("div",{className:`w-full md:w-2/3 ${p.badgesBg} p-10`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(ze,{className:"w-8 h-8 text-amber-400"}),e.jsx("h3",{className:"text-2xl font-black leading-none",children:x?"å­¦ä¹ æˆé•¿å‹‹ç« ":"è£èª‰æˆå°±"})]}),x?e.jsx("div",{className:"grid grid-cols-2 gap-6",children:(ce=s.htBadges)==null?void 0:ce.map(t=>e.jsxs("div",{className:`${_.cardClass} bg-white/80 backdrop-blur-sm p-4 flex flex-col items-center justify-center shadow-sm`,children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center mb-2 shadow-sm ${o==="boy"?"bg-blue-600 text-white":"bg-rose-50 text-rose-300"}`,children:t.level==="progress"?e.jsx(ae,{className:"w-6 h-6"}):t.level==="potential"?e.jsx(re,{className:"w-6 h-6"}):e.jsx(se,{className:"w-6 h-6"})}),e.jsx("h4",{className:"font-black text-sm mb-1 leading-none text-center",children:t.name}),e.jsx("div",{className:"flex gap-0.5 mb-2",children:[...Array(5)].map((N,$)=>e.jsx(se,{className:`w-3.5 h-3.5 ${$<(t.stars||0)?"text-yellow-400 fill-yellow-400":"text-slate-200 fill-slate-100"}`},$))}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400/80 text-center leading-tight italic",children:["â€œ",t.description,"â€"]})]},t.name))}):e.jsxs("div",{className:"flex gap-10",children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform rotate-3 mb-4 border-4 border-white ${o==="boy"?"bg-amber-400":o==="girl"?"bg-rose-300":"bg-amber-200"}`,children:e.jsx(se,{className:`w-12 h-12 ${o==="boy"?"text-white":"text-amber-700"}`})}),e.jsx("p",{className:"font-black text-lg mb-2 leading-none text-center",children:s.completionBadge.name}),e.jsx("div",{className:`${_.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.completionBadge.description})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-28 h-28 rounded-[2rem] flex items-center justify-center shadow-lg transform -rotate-3 mb-4 border-4 border-white ${o==="boy"?"bg-indigo-600":o==="girl"?"bg-rose-400":"bg-amber-500"}`,children:e.jsx(de,{className:"w-12 h-12 text-white shadow-sm"})}),e.jsx("p",{className:"font-black text-lg mb-2 leading-none text-center",children:s.accuracyBadge.name}),e.jsx("div",{className:`${_.cardClass} bg-white/60 p-4 text-center text-xs font-bold leading-relaxed`,children:s.accuracyBadge.description})]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsxs("div",{className:`w-full ${x?"lg:w-[45%]":"lg:w-[55%]"} border-b-4 lg:border-b-0 lg:border-r-4 ${p.border} bg-white p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3 whitespace-nowrap leading-none",children:[e.jsx(Ge,{className:"w-8 h-8 text-indigo-500"}),x?`${s.studentName}åŒå­¦ å­¦ä¹ è®°å½•`:"å­¦ä¹ é—¯å…³è®°å½•"]}),e.jsx("div",{className:"mt-2 flex items-center justify-center px-6 h-8 bg-indigo-50 rounded-full text-indigo-600 font-black text-xs w-fit leading-none shadow-sm",children:"ä¸€èŠ‚è¯¾20åˆ†é’Ÿï¼ŒçŸ­æ—¶é«˜æ•ˆï¼Œæ¯å¤©ç»ƒå‡ºæ•ˆæœï¼"})]}),x&&s.errorAnalysis&&e.jsx("div",{className:"mb-6 p-5 bg-rose-50 rounded-[1.5rem] border-2 border-rose-100 shadow-sm animate-in slide-in-from-left duration-500 flex items-center",children:e.jsxs("p",{className:"text-xs font-bold text-rose-800/80 leading-relaxed italic",children:["â€œ",s.errorAnalysis.content,"â€"]})}),e.jsx("div",{className:`${_.cardClass} border-2 overflow-hidden flex-grow`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:p.tableHeader,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left leading-none",children:"å•å…ƒå†…å®¹"}),!x&&e.jsx("th",{className:"px-4 py-4 text-center leading-none",children:"å­¦ä¹ å…³è”"}),e.jsx("th",{className:"px-4 py-4 text-center leading-none",children:"å­¦ä¹ æ—¶é•¿"}),!x&&e.jsx("th",{className:"px-4 py-4 text-center leading-none",children:"å­¦ä¹ åˆ†æ"}),x&&e.jsx("th",{className:"px-4 py-4 text-right leading-none",children:"é”™è¯¯ç»Ÿè®¡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:W.map((t,N)=>{const $=Math.max(...W.map(I=>I.wrongCount),1),A=t.wrongCount/$*80;return e.jsxs("tr",{className:`transition-colors ${N%2===0?"bg-white":"bg-slate-50/50"} hover:bg-slate-100`,children:[e.jsx("td",{className:"px-4 py-5 font-black whitespace-nowrap text-xs leading-none",children:t.unitName}),!x&&e.jsx("td",{className:"px-4 py-5 text-center align-middle",children:ke(t.association)}),e.jsx("td",{className:"px-4 py-5 text-center font-bold opacity-50 text-xs leading-none",children:ct(t.timeSpentSeconds)}),!x&&e.jsx("td",{className:`px-4 py-5 text-center font-black text-[11px] whitespace-nowrap leading-none ${t.status==="low"?"text-slate-300":"text-indigo-500"}`,children:t.analysis}),x&&e.jsx("td",{className:"px-4 py-5 text-right min-w-[120px]",children:e.jsxs("div",{className:"flex items-center justify-end gap-3 h-full",children:[e.jsx("div",{className:"h-2 bg-rose-100 rounded-full overflow-hidden w-20 flex-shrink-0",children:e.jsx("div",{className:"h-full bg-rose-400 rounded-full",style:{width:`${A}%`}})}),e.jsx("span",{className:"font-black text-rose-400 text-xs w-6 text-right leading-none",children:t.wrongCount})]})})]},t.unitNumber)})})]})})}),!x&&ee&&e.jsx("div",{className:"mt-8 space-y-6 animate-in fade-in duration-500",children:e.jsxs("div",{className:`${_.cardClass} bg-indigo-600 text-white p-8 relative overflow-hidden shadow-xl`,children:[e.jsx("div",{className:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"}),e.jsxs("h4",{className:"text-xl font-black flex items-center gap-3 mb-6 leading-none",children:[e.jsx(Je,{className:"w-6 h-6"})," ğŸ“ˆ å­¦ä¹ é‡Œç¨‹ç¢‘"]}),e.jsxs("p",{className:"text-sm font-bold leading-loose opacity-90",children:["æœ¬æœˆä½ ç´¯è®¡å­¦ä¹  ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1 leading-none",children:ee.totalMinutes})," åˆ†é’Ÿã€‚å®Œæˆã€",e.jsx("span",{className:"text-yellow-300 text-lg mx-1 leading-none",children:ee.totalKPs}),"ä¸ªçŸ¥è¯†ç‚¹ã€‘ç›¸å½“äºæ”»å…‹äº† ",e.jsx("span",{className:"text-yellow-300 text-lg mx-1 leading-none",children:ee.totalErrors}),"ä¸ªé«˜é¢‘æ˜“é”™ç‚¹ã€‚"]})]})})]}),e.jsxs("div",{className:`w-full ${x?"lg:w-[55%]":"lg:w-[45%]"} ${p.chartBg} p-8 flex flex-col`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-8",children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3 whitespace-nowrap leading-none",children:[e.jsx(Ve,{className:"w-8 h-8 text-amber-500"}),x?`${s.studentName}åŒå­¦ æ­£ç¡®ç‡è¶‹åŠ¿`:"è¶‹åŠ¿åˆ†æ"]}),e.jsxs("div",{className:"flex items-center gap-2 print:hidden",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>M("accuracy"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="accuracy"?"bg-white shadow-sm text-indigo-600":"text-slate-400"} leading-none`,children:"æ­£ç¡®ç‡"}),e.jsx("button",{onClick:()=>M("passRate"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${v==="passRate"?"bg-white shadow-sm text-indigo-600":"text-slate-400"} leading-none`,children:"è¿‡å…³ç‡"})]}),x&&e.jsx("button",{onClick:g,className:`p-2 rounded-xl border-2 transition-all ${y?"bg-amber-100 border-amber-300 text-amber-700":"bg-white text-slate-400"}`,children:y?e.jsx(Ye,{className:"w-4 h-4"}):e.jsx(Ze,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:`${_.cardClass} bg-white p-6 h-[400px] mb-8 relative shadow-md border-indigo-50 border-4`,children:e.jsx(pt,{data:W,color:x?"#818cf8":"#f97316",isZoomed:x&&y,metric:v})}),e.jsxs("div",{className:`${_.cardClass} bg-white p-6 shadow-sm border-2 ${p.border} flex flex-col justify-center min-h-[100px]`,children:[e.jsxs("h4",{className:`text-lg font-black mb-4 flex items-center gap-2 ${p.headerText} leading-none`,children:[e.jsx(ae,{className:"w-5 h-5 text-yellow-400 fill-current"}),s.trendAnalysis.title]}),e.jsxs("p",{className:"font-bold text-sm leading-relaxed opacity-80 italic",children:["â€œ",s.trendAnalysis.content,"â€"]})]})]})]}),e.jsx("div",{className:"bg-white p-10",children:e.jsxs("div",{className:`${_.cardClass} border-2 ${p.border} overflow-hidden shadow-sm`,children:[e.jsxs("div",{className:`${p.rankingHeaderBg} p-6 border-b flex justify-between items-center`,children:[e.jsxs("h3",{className:"text-2xl font-black flex items-center gap-3 leading-none",children:[e.jsx(Xe,{className:"w-8 h-8 text-stone-400"}),x?"æ­£ç¡®ç‡æ’å":"é€šå…³ç‡æ’å"]}),e.jsxs("span",{className:"font-bold text-xs opacity-40 leading-none",children:["å…±æœ‰ ",ie," åå­¦å‘˜å‚ä¸ç»Ÿè®¡"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50/80 text-slate-400 font-bold text-[10px] uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left w-20 leading-none text-center",children:"åæ¬¡"}),e.jsx("th",{className:"px-6 py-4 text-left leading-none",children:"å§“å"}),e.jsx("th",{className:"px-6 py-4 text-left leading-none",children:"å­¦å· (UID)"}),x&&ge.map(t=>e.jsx("th",{className:`px-2 py-4 text-center whitespace-nowrap leading-none ${t===0?"bg-amber-50 text-amber-600 border-r-2 border-amber-100":""}`,children:t===0?"è¯¾å‰æµ‹":`L${t}`},t)),e.jsx("th",{className:"px-6 py-4 text-right leading-none",children:x?"ç»¼åˆå¾—åˆ†":"é€šå…³ç‡"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:je.map(t=>{const N=t.name===s.studentName,$=N?t.name:(t.name.charAt(0)+"x".repeat(Math.min(t.name.length-1,1))).slice(0,4);return e.jsxs("tr",{className:`${N?p.rankingHighlightRow:"hover:bg-slate-50/50"} transition-all`,children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsx("span",{className:`w-9 h-9 rounded-2xl flex items-center justify-center font-black ${t.rank<=3?"bg-amber-100 text-amber-600":"bg-slate-100 text-slate-400"} ${N?"ring-4 ring-amber-400/20":""} leading-none text-center`,children:t.rank})})}),e.jsxs("td",{className:`px-6 py-5 font-black text-base ${N?"text-amber-600":"opacity-70"} flex items-center h-full`,children:[e.jsx("span",{className:"leading-none",children:$}),N&&e.jsx("span",{className:"ml-2 flex items-center justify-center text-[10px] bg-amber-400 text-white px-2 h-4 rounded-full font-sans uppercase leading-none font-black",children:"ME"})]}),e.jsx("td",{className:"px-6 py-5 font-black text-sm font-mono opacity-50 leading-none",children:t.userId}),x&&ge.map(A=>e.jsx("td",{className:`px-2 py-5 text-center font-bold text-[10px] ${A===0?"bg-amber-50/30 border-r-2 border-amber-100/50":""} ${t.accuracies[A]!==void 0?"text-slate-600":"text-slate-200"} leading-none`,children:t.accuracies[A]!==void 0?`${t.accuracies[A].toFixed(0)}%`:"-"},A)),e.jsx("td",{className:"px-6 py-5 text-right font-black text-lg whitespace-nowrap leading-none",children:x?t.totalScore:`${t.completionRate.toFixed(1)}%`})]},t.userId)})})]})}),e.jsx("div",{className:`${p.rankingBannerBg} ${p.rankingBannerText} p-8 text-center font-black text-sm italic leading-relaxed`,children:_e()})]})}),e.jsx("div",{className:`${p.teacherSection} p-12 text-center relative overflow-hidden flex flex-col items-center justify-center`,children:e.jsxs("div",{className:"relative z-10 max-w-3xl mx-auto flex flex-col items-center",children:[e.jsx(Qe,{className:"w-12 h-12 mx-auto mb-6 opacity-40"}),e.jsx("p",{className:"text-2xl font-black italic mb-4 opacity-90 leading-snug text-center",children:"â€œ å­¦ä¹ ä¸ä»…æ˜¯åˆ†æ•°çš„ç´¯ç§¯ï¼Œæ›´æ˜¯æ€ç»´çš„ç ´å£³è€Œå‡ºã€‚äº²çˆ±çš„å®¶é•¿ï¼Œå®è´æ­£åœ¨ç”¨æ¯ä¸€ä¸ªç™¾åˆ†ç‚¹çš„è¿›æ­¥ï¼Œä¹¦å†™å±äºè‡ªå·±çš„æœªæ¥ï¼è®©æˆ‘ä»¬å…±åŒå‘µæŠ¤è¿™ä»½æˆé•¿ã€‚ â€"}),e.jsxs("p",{className:"font-bold opacity-60 leading-none",children:["â€” æ‚¨çš„è¾…å¯¼è€å¸ˆ ",s.teacher]})]})})]})]})},Nt=({data:s,onSelectStudent:r,onReupload:i})=>{const[l,a]=m.useState(""),[n,o]=m.useState("all"),d=m.useMemo(()=>gt(s),[s]),j=m.useMemo(()=>{const c=new Set(d.map(y=>y.grade));return Array.from(c).filter(Boolean)},[d]),f=m.useMemo(()=>d.filter(c=>{const y=c.name.toLowerCase().includes(l.toLowerCase())||c.teacher.toLowerCase().includes(l.toLowerCase()),g=n==="all"||c.grade===n;return y&&g}),[d,l,n]);return e.jsxs("div",{className:"max-w-5xl mx-auto my-8 space-y-6 font-sans",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-indigo-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-xl text-indigo-600",children:e.jsx(fe,{className:"w-6 h-6"})}),"å­¦ç”Ÿæ•°æ®åˆ—è¡¨"]}),e.jsxs("p",{className:"text-indigo-400 font-medium mt-2 ml-1",children:["å…±å¯¼å…¥ ",d.length," åå­¦ç”Ÿï¼Œ",s.length," æ¡å­¦ä¹ è®°å½•"]})]}),e.jsx("button",{onClick:i,className:"text-sm font-bold text-gray-400 hover:text-red-500 underline transition-colors",children:"é‡æ–°ä¸Šä¼ æ–‡ä»¶"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-indigo-50/50 p-2 rounded-2xl border border-indigo-100",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(pe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsx("input",{type:"text",placeholder:"æœç´¢å§“åæˆ–è¾…å¯¼è€å¸ˆ...",value:l,onChange:c=>a(c.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 placeholder-indigo-300 focus:outline-none focus:ring-0 font-medium transition-all"})]}),e.jsxs("div",{className:"relative min-w-[200px]",children:[e.jsx(be,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-300"}),e.jsxs("select",{value:n,onChange:c=>o(c.target.value),className:"w-full pl-12 pr-10 py-3 bg-white border-2 border-transparent focus:border-indigo-300 rounded-xl text-indigo-800 font-medium appearance-none focus:outline-none focus:ring-0 cursor-pointer transition-all",children:[e.jsx("option",{value:"all",children:"æ‰€æœ‰å¹´çº§"}),j.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg border-2 border-indigo-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-indigo-50/50 border-b border-indigo-100 text-indigo-400 uppercase font-bold text-xs tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-5",children:"å­¦ç”Ÿå§“å"}),e.jsx("th",{className:"px-6 py-5",children:"å¹´çº§"}),e.jsx("th",{className:"px-6 py-5",children:"è¾…å¯¼è€å¸ˆ"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"è®°å½•æ•°"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"æœ€æ–°è¿›åº¦"}),e.jsx("th",{className:"px-6 py-5 text-right",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"divide-y divide-indigo-50",children:f.length>0?f.map(c=>e.jsxs("tr",{className:"hover:bg-indigo-50/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsx("div",{className:"font-bold text-lg text-indigo-900",children:c.name})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-blue-100 text-blue-600",children:[e.jsx(tt,{className:"w-3.5 h-3.5"}),c.grade]})}),e.jsx("td",{className:"px-6 py-5 font-medium text-gray-600",children:c.teacher}),e.jsx("td",{className:"px-6 py-5 text-center font-bold text-indigo-300",children:c.unitCount}),e.jsxs("td",{className:"px-6 py-5 text-center font-medium text-gray-500",children:["ç¬¬ ",c.lastUnit," å•å…ƒ"]}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsxs("button",{onClick:()=>r(c.name),className:"inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-xs px-5 py-2.5 rounded-full transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:["ç”ŸæˆæŠ¥å‘Š",e.jsx(st,{className:"w-3.5 h-3.5"})]})})]},c.name)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-400",children:[e.jsx("div",{className:"text-4xl",children:"ğŸ¤”"}),e.jsx("div",{className:"font-medium",children:"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­¦ç”Ÿæ•°æ®"})]})})})})]})}),e.jsx("div",{className:"bg-indigo-50/30 px-6 py-4 border-t border-indigo-100 text-xs font-bold text-indigo-300 flex justify-between",children:e.jsxs("span",{children:["æ˜¾ç¤º ",f.length," / ",d.length," ä½å­¦ç”Ÿ"]})})]})]})},q={UNIT_NAMES:"xueqiu_custom_unit_names",ASSOCIATIONS:"xueqiu_custom_associations",KP_COUNTS:"xueqiu_custom_kp_counts",ERROR_COUNTS:"xueqiu_custom_error_counts"};function jt(){const[s,r]=m.useState("upload"),[i,l]=m.useState("counselor"),[a,n]=m.useState([]),[o,d]=m.useState(null),[j,f]=m.useState(null),[c,y]=m.useState([]),[g,v]=m.useState({min:1,max:1}),[M,T]=m.useState("default"),[h,w]=m.useState(Object.keys(we)[0]),[C,u]=m.useState(!1),[S,L]=m.useState("accuracy"),[H,_]=m.useState(()=>{const b=localStorage.getItem(q.UNIT_NAMES);return b?JSON.parse(b):[]}),[p,x]=m.useState(()=>{const b=localStorage.getItem(q.ASSOCIATIONS);return b?JSON.parse(b):[]}),[O,K]=m.useState(()=>{const b=localStorage.getItem(q.KP_COUNTS);return b?JSON.parse(b):[]}),[P,G]=m.useState(()=>{const b=localStorage.getItem(q.ERROR_COUNTS);return b?JSON.parse(b):[]});m.useEffect(()=>{localStorage.setItem(q.UNIT_NAMES,JSON.stringify(H)),localStorage.setItem(q.ASSOCIATIONS,JSON.stringify(p)),localStorage.setItem(q.KP_COUNTS,JSON.stringify(O)),localStorage.setItem(q.ERROR_COUNTS,JSON.stringify(P))},[H,p,O,P]);const k=b=>{n(b),r("list")},R=b=>{const B=dt(a,b);if(B.length===0)return alert("è¯¥å­¦ç”Ÿæ²¡æœ‰æœ‰æ•ˆæ•°æ®");const F=B[0],X=B[B.length-1];y(B),v({min:F,max:X}),f(b);const V=a.find(U=>U.real_name===b);if(V){const U=V.package_grade||"",D=U.toLowerCase().includes("one")?"ä¸€å¹´çº§":U.toLowerCase().includes("two")?"äºŒå¹´çº§":U.toLowerCase().includes("three")?"ä¸‰å¹´çº§":U.toLowerCase().includes("four")?"å››å¹´çº§":U.toLowerCase().includes("five")?"äº”å¹´çº§":U.toLowerCase().includes("six")?"å…­å¹´çº§":"";D&&!h.startsWith(D)&&w(D)}const Q=he(a,b,i,{min:F,max:X});Q&&(d(Q),r("report"))},Y=b=>{const B=a.find(F=>String(F.user_id)===String(b));B?R(B.real_name):alert(`æœªæ‰¾åˆ° ID ä¸º ${b} çš„å­¦å‘˜`)},Z=(b,B)=>{if(!j)return;v({min:b,max:B});const F=he(a,j,i,{min:b,max:B});F&&d(F)},J=()=>{n([]),d(null),f(null),r("upload")};return e.jsxs("div",{className:"min-h-screen pb-10 bg-slate-50 font-sans",children:[e.jsx("header",{className:"bg-white border-b-4 border-indigo-100 py-4 mb-8 shadow-sm print:hidden",children:e.jsx("div",{className:"container mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline gap-2",children:[e.jsx("h1",{className:"text-2xl font-black text-indigo-600 flex items-center gap-2 cursor-pointer",onClick:J,children:"ğŸ“ å­¦æƒ…åé¦ˆç”Ÿæˆå™¨"}),e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"ä½¿ç”¨é—®é¢˜å¯ç•™è¨€sundong@xueqiulearning.com"})]})})}),e.jsxs("main",{className:"container mx-auto px-4",children:[s==="upload"&&e.jsx(ft,{onDataLoaded:k,role:i,onRoleChange:l}),s==="list"&&e.jsx(Nt,{data:a,onSelectStudent:R,onReupload:J}),s==="report"&&o&&e.jsx(wt,{data:o,rawData:a,onReset:J,onBack:()=>r("list"),availableUnits:c,currentRange:g,onRangeChange:Z,currentTheme:M,onThemeChange:T,selectedCurriculumKey:h,setSelectedCurriculumKey:w,onSwitchStudentById:Y,isChartZoomed:C,onToggleZoom:()=>u(!C),trendMetric:S,onToggleMetric:b=>L(b),customUnitNames:H,onUpdateCustomUnitNames:_,customAssociations:p,onUpdateCustomAssociations:x,customKPCounts:O,onUpdateCustomKPCounts:K,customErrorCounts:P,onUpdateCustomErrorCounts:G})]})]})}const Ne=document.getElementById("root");if(!Ne)throw new Error("Could not find root element to mount to");const yt=Ae.createRoot(Ne);yt.render(e.jsx(Me.StrictMode,{children:e.jsx(jt,{})}));
